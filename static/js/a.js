$.extend({xm:{},ss:{doc:$(document),win:$(window),body:$("body"),lay:$("#lay")},ms:{version:"0.5",debug:0,rootpath:"/",ampath:"/am/",bspath:"/bb/",tplpath:"/tpl/",imgpath:"/static/img/",cnum:[50,40,27,36,34,24,21,4,31,24,22,25,29,36,10,13,10,42,150,31,12,8,66,52,5,48,12,14,3,9,1,4,7,3,3,3,2,14,4,28,16,24,21,28,16,16,13,6,6,4,4,5,3,6,4,3,1,13,5,5,3,5,1,1,1,22],bibleinfo:{},bibles:{},media:{},playindex:-1,search:"",topic:{},bibleshort:["GEN","EXO","LEV","NUM","DEU","JOS","JDG","RUT","1SA","2SA","1KI","2KI","1CH","2CH","EZR","NEH","EST","JOB","PSA","PRO","ECC","SNG","ISA","JER","LAM","EZK","DAN","HOS","JOL","AMO","OBA","JON","MIC","NAM","HAB","ZEP","HAG","ZEC","MAL","MAT","MRK","LUK","JHN","ACT","ROM","1CO","2CO","GAL","EPH","PHP","COL","1TH","2TH","1TI","2TI","TIT","PHM","HEB","JAS","1PE","2PE","1JN","2JN","3JN","JUD","REV"]},bj:{},cm:{}}),$.fn.th=$.fn.triggerHandler;!function(t){var e=(new Date).getTime();t.cm.guid=function(){return e+=99}}(jQuery),$.extend($.cm,{bjs:function(t){var e,n,r,i,s=$.bj,a=$.ss,o=$.ms,c=$.cm,f=$.xm;for(r=$(t).find("div.mod[id]"),e=0,n=r.length;n>e;e++){var u,p,l,d,m,h,b=r[e],g=$(b),v=b.id;if(!g.data("guid"))if(l=s[v])for(l=l.split("|"),u=v+c.guid(),g.data("guid",u),p={},d=0,m=l.length;m>d;d++)h=l[d].split("/"),i=$.xm[h[0]],i&&i(b,$.extend({id:u,co:p,ms:o,cm:c,xm:f},a),h[1]);else $.xm[v]&&(u=v+c.guid(),g.data("guid",u),$.xm[v](b,$.extend({id:u,co:{},ms:o,cm:c,xm:f},a)))}},ubj:function(t){var e,n,r,i,s=$.ss;for(r=$(t).find("div.mod[id]"),e=0,n=r.length;n>e;e++)i=$(r[e]).data("guid"),i&&(i="."+i,$(r[e]).th("empty"),s.doc.unbind(i),s.win.unbind(i))},ucode:function(t){return/\?/.test(t)?"&":"?"},act:function(t){if(!t)return!1;var e=$.ss.doc;e.th("act",[t]),$.each(t,function(t,n){switch(t){case"200":case"msg":e.th("msg",[n]);break;case"500":case"404":e.th("msg",[n,1]);break;case"reset":$("form[name="+n+"]",e).reset();break;case"submit":$("form[name="+n+"]",e).submit();break;case"href":$.isArray(n)?setTimeout(function(){location.href=n[0]},n[1]):"string"==typeof n?location.href=n:setTimeout(function(){location.reload(!0)},n||0);break;case"sdctrl":e.th(t,n)}})},attr:function(t,e,n){var r,i,s=n.length;for(r=0;s>r;r++)i=e.attr(n[r]),void 0!==i&&t.attr(n[r],i);return t},lab:function(t){return"<strong>"+(t.attr("lab")||t.prev("label").text()||t.parent("td").prev().text()||t.closest("td").prev().text()||t.parent().contents(":first").text()||"").replace(/　|：|:/g,"")+"</strong> "},valid:function(t,e,n){var r,i,s,a,o=(e.is("form")?e.find(":input[name][type!=submit]").filter(":not(input[type!=hidden]:hidden)"):e).validator(t),c=o[0];$(o[1]).removeClass("wrg");for(r in c){for(a=$(c[r][0]),s=[],i=1;i<c[r].length;i++)s.push(c[r][i][1]);a.addClass("wrg").attr("wtit",$.cm.lab(a)+s.join("<br/>"))}return n&&!1===n(c)||!c[0]||$(c[0][0]).trigger("wrongtip"),c.length},svalid:function(t,e){var n,r,i,s;if(e)for(n in e)r=$(":input[name="+n+"]:first",t),r[0]&&(s=r.attr("vd"),s&&(s=s.split("#")[1],s&&(r=$((s&&$.isFunction(r[s])?r[s]()[0]:s&&$("*[vw="+s+"]","g"===s.substr(0,1)?null:t)[0])||r))),r.addClass("wrg").attr("wtit",$.cm.lab(r)+e[n]),i||(i=1,r.trigger("wrongtip")))},getBible:function(t,e,n){var r=$.ms,i=r.runtime,s=i["bible"+t],a=s+"/"+r.bibleshort[i["roll"+t]-1]+"/"+i["more"+t]+"/";r.bibles[a]?e(r.bibles[a]):r.bibleinfo[s]?$.get(r.bspath+a,function(t){r.bibles[a]=t,e(t)}):$.ajax({url:r.bspath+"info/"+a,success:function(t){t=t.split("\n\n");var n=t[0].split("|"),i=n[2].split("=");r.bibleinfo[n[0]]={bx:i[0].split(","),bm:i[1].split(","),cb:n[0],cv:n[1],av:parseInt(n[3],10),su:parseInt(n[4],10)||0,cp:n[5]},r.bibles[a]=t[1],e(t[1])},error:function(t,e,r){n&&n(t,e,r)}})},getInfo:function(t,e,n){var r=$.ms.bibleinfo[t];r?e(r):$.ajax({url:$.ms.bspath+"info/"+t+"/",success:function(t){t=t.split("|");var n=t[2].split("="),r={bx:n[0].split(","),bm:n[1].split(","),cb:t[0],cv:t[1],av:parseInt(t[3],10),su:parseInt(t[4],10)||0,cp:t[5]};$.ms.bibleinfo[t[0]]=r,e(r)},error:function(t,e,r){n&&n(t,e,r)}})},filterHtml:function(t){return t.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;")},countDay:function(t,e){return Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-(t||0))/864e5)},getVerse:function(t,e){function n(t,e){var n;for(n=0;n<e.length;n++)if(t[e[n]])return!0;return!1}var r,i,s,a,o,c=$(t).find("b"),f=$.ms.runtime,u=[],p={};if("number"!=typeof e)for(e=e.split(","),r=0;r<e.length;r++)if(i=e[r].split("-"),i.length>1)for(s=parseInt(i[0],10);s<=parseInt(i[1]||200,10);s++)p[s]=1;else p[i[0]]=1;else e>0&&(p[e]=1);for(r=0;r<c.length;r++){if(i=c[r].innerHTML,i=(f.lstype?i.split(":")[1]:i).split("-"),i[1])for(a=[],s=parseInt(i[0],10);s<=parseInt(i[1],10);s++)a.push(s);else a=[i[0]];if(n(p,a))for(o=$(c[r]),u.push(o);;)if(o=o.next(),o.is("span"))u.push(o);else{if(o[0])break;if(o=u[u.length-1].parent().next(),o.is("p")||(o=o.next()),(!o.is("p")||o.is("p.b"))&&(o=o.next()),o.is("h4")&&(o=o.next()),o=o.children(":first"),!o.is("span"))break;u.push(o)}}return u[0]?u:!1},toMid:function(t,e,n){if(n[0]){var r=n.offset().top,i=e.offset().top,s=n.height(),a=t.height();return s>a&&(s=a),t.th("rollbar",["to",(r-i-a/2+s/2)/(e.outerHeight(!0)-a),0]),n}},getMedia:function(t,e,n){var r=$.ms,i=r.runtime,s=i.bible+"/"+i.roll+"/"+($.cm.exmore(i.more,"minchapter")+(void 0!==n?n:r.offset||0))+"/";r.media[s]?t(e>=0?r.media[s][e]:r.media[s]):$.getJSON(r.bspath+"audio/"+s,function(n){r.media[s]=n,t(e>=0?n[e]:n)})},setHeight:function(t,e,n){function r(){var t=$.ss.body.height(),r=e.offset().top,i=n.height(),s=t-r-10;e.css("height",parseInt(i>s?s:i,10)+"px")}return r(),$.ss.win.bind("resize."+t,function(){r()}),r},getTopic:function(t,e){var n=$.ms;n.topic[t]?e(t,n.topic[t]):$.post(n.rootpath+"tp/",{topic:t},function(r){var i=r.replace(/^\[(\S+?)(\d+?:[\d\-,]+?)\](.+?)$/gm,"<h5>$1$2</h5><p>$3</p>").split("\n");t=i.shift(),n.topic[t]=i,e(t,i)})},exmore:function(t,e,n){var r,i,s,a,o,c,f;if(t=t.toString(),s=t.match(/^\d+$/))a=s[0];else if(s=t.match(/^(\d+)-(\d+)$/))a=s[1],c=s[2];else if(s=t.match(/^(\d+):([\d,\-]+)$/))a=s[1],o=s[2];else if(s=t.match(/^(\d+):([\d,]+)-(\d+):([\d,]+)$/))a=s[1],o=s[2],c=s[3],f=s[4];else{if(!(s=t.match(/^(\d+)-(\d+):([\d,]+)$/)))return!1;a=s[1],o="1",c=s[2],f=s[3]}switch(e){case"minchapter":return parseInt(a,10);case"maxchapter":return parseInt(c||a,10);case"strchapter":return a+(c?"-"+c:"");case"listchapter":for(r=[],i=parseInt(a,10);i<=parseInt(c||a,10);i++)r.push(i);return r;case"inchapter":return n>=parseInt(a,10)&&n<=parseInt(c||a,10);case"verse":return[o,f];default:return!0}}});!function(e,t,a){a[e]={instanceCount:0,instances:{},flashSource:'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" id="$1" width="1" height="1" name="$1" style="position: absolute; left: -1px;"><param name="movie" value="$2?playerInstance='+e+'.instances[\'$1\']&datetime=$3"><param name="allowscriptaccess" value="always"><embed name="$1" src="$2?playerInstance='+e+'.instances[\'$1\']&datetime=$3" width="1" height="1" allowscriptaccess="always"></object>',settings:{autoplay:!1,loop:!1,preload:!0,swfLocation:"/static/js/audiojs.swf",useFlash:function(){var e=document.createElement("audio");return!(e.canPlayType&&e.canPlayType("audio/mpeg;").replace(/no/,""))}(),hasFlash:function(){if(navigator.plugins&&navigator.plugins.length&&navigator.plugins["Shockwave Flash"])return!0;if(navigator.mimeTypes&&navigator.mimeTypes.length){var e=navigator.mimeTypes["application/x-shockwave-flash"];return e&&e.enabledPlugin}try{{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}return!0}catch(t){}return!1}(),flashError:function(){var t=this.settings.createPlayer,s=n(t.errorMessageClass,this.wrapper),i=gettext('Missing <a href="http://get.adobe.com/flashplayer/">flash player</a> plugin.');a[e].helpers.addClass(this.wrapper,t.errorClass),s.innerHTML=i},init:function(){var t=this.settings.createPlayer;a[e].helpers.addClass(this.wrapper,t.loadingClass)},playPause:function(){this.playing?this.settings.play():this.settings.pause()}},create:function(e,t){var t=t||{};return e.length?this.createAll(t,e):this.newInstance(e,t)},createAll:function(e,t){var a=t||document.getElementsByTagName("audio"),n=[];e=e||{};for(var s=0,i=a.length;i>s;s++)n.push(this.newInstance(a[s],e));return n},newInstance:function(e,n){{var s=this.helpers.clone(this.settings),i="audiojs"+this.instanceCount,r="audiojs_wrapper"+this.instanceCount;this.instanceCount++}null!=e.getAttribute("autoplay")&&(s.autoplay=!0),null!=e.getAttribute("loop")&&(s.loop=!0),"none"==e.getAttribute("preload")&&(s.preload=!1),n&&this.helpers.merge(s,n),s.createPlayer.markup?e=this.createPlayer(e,s.createPlayer,r):e.parentNode.setAttribute("id",r);var l=new a[t](e,s);return s.useFlash&&s.hasFlash?(this.injectFlash(l,i),this.attachFlashEvents(l.wrapper,l)):s.useFlash&&!s.hasFlash&&this.settings.flashError.apply(l),(!s.useFlash||s.useFlash&&s.hasFlash)&&this.attachEvents(l.wrapper,l),this.instances[i]=l,l},createPlayer:function(e,t,a){var n=document.createElement("div"),s=e.cloneNode(!0);return n.setAttribute("class","audiojs"),n.setAttribute("className","audiojs"),n.setAttribute("id",a),s.outerHTML&&!document.createElement("audio").canPlayType?(s=this.helpers.cloneHtml5Node(e),n.innerHTML=t.markup,n.appendChild(s),e.outerHTML=n.outerHTML,n=document.getElementById(a)):(n.appendChild(s),n.innerHTML=n.innerHTML+t.markup,e.parentNode.replaceChild(n,e)),n.getElementsByTagName("audio")[0]},attachEvents:function(t,s){if(s.settings.createPlayer){var i=s.settings.createPlayer,r=n(i.playPauseClass,t),l=n(i.scrubberClass,t),o=function(e){var t=0;if(e.offsetParent)do t+=e.offsetLeft;while(e=e.offsetParent);return t};a[e].events.addListener(r,"click",function(){s.playPause.apply(s)}),a[e].events.addListener(l,"click",function(e){var t=e.clientX-o(this);s.skipTo(t/l.offsetWidth)}),s.settings.useFlash||(a[e].events.trackLoadProgress(s),a[e].events.addListener(s.element,"timeupdate",function(){s.updatePlayhead.apply(s)}),a[e].events.addListener(s.element,"ended",function(){s.trackEnded.apply(s)}),a[e].events.addListener(s.source,"error",function(){clearInterval(s.readyTimer),clearInterval(s.loadTimer),s.settings.loadError.apply(s)}))}},attachFlashEvents:function(e,t){t.swfReady=!1,t.load=function(e){t.mp3=e,t.swfReady&&t.element.load(e)},t.loadProgress=function(e,a){if(t.loadedPercent=e,t.duration=a,t.settings.loadStarted.apply(t),t.settings.loadProgress.apply(t,[e]),t.skiptime>0&&t.duration>0&&t.swfReady){var n=t.skiptime;t.skiptime=0,setTimeout(function(){t.skipToTime.call(t,n)},0)}},t.skipTo=function(e){t.updatePlayhead.call(t,e),t.element.skipTo(e)},t.skipToTime=function(e){if(t.duration){var a=(e+.2)/t.duration;t.updatePlayhead.call(t,a),t.element.skipTo(a)}else t.skiptime=e},t.updatePlayhead=function(e){t.settings.updatePlayhead.call(t,e)},t.play=function(){t.settings.preload||(t.settings.preload=!0,t.element.init(t.mp3)),t.playing=!0,t.element.pplay(),t.settings.play.apply(t)},t.pause=function(){t.playing=!1,t.element.ppause(),t.settings.pause.apply(t)},t.setVolume=function(e){t.element.setVolume(e)},t.loadStarted=function(){t.swfReady=!0,t.settings.preload&&t.element.init(t.mp3),t.settings.autoplay&&t.play.apply(t)}},injectFlash:function(e,t){var a=this.flashSource.replace(/\$1/g,t);a=a.replace(/\$2/g,e.settings.swfLocation),a=a.replace(/\$3/g,+new Date+Math.random());var n=e.wrapper.innerHTML,s=document.createElement("div");s.innerHTML=a+n,e.wrapper.innerHTML=s.innerHTML,e.element=this.helpers.getSwf(t)},helpers:{merge:function(e,t){for(attr in t)(e.hasOwnProperty(attr)||t.hasOwnProperty(attr))&&(e[attr]=t[attr])},clone:function(e){if(null==e||"object"!=typeof e)return e;var t=new e.constructor;for(var a in e)t[a]=arguments.callee(e[a]);return t},addClass:function(e,t){var a=new RegExp("(\\s|^)"+t+"(\\s|$)");a.test(e.className)||(e.className+=" "+t)},removeClass:function(e,t){var a=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(a," ")},cloneHtml5Node:function(e){var t=document.createDocumentFragment(),a=t.createElement?t:document;a.createElement("audio");var n=a.createElement("div");return t.appendChild(n),n.innerHTML=e.outerHTML,n.firstChild},getSwf:function(e){var t=document[e]||window[e];return t.length>1?t[t.length-1]:t}},events:{memoryLeaking:!1,listeners:[],addListener:function(t,n,s){t.addEventListener?t.addEventListener(n,s,!1):t.attachEvent&&(this.listeners.push(t),this.memoryLeaking||(window.attachEvent("onunload",function(){if(this.listeners)for(var t=0,n=this.listeners.length;n>t;t++)a[e].events.purge(this.listeners[t])}),this.memoryLeaking=!0),t.attachEvent("on"+n,function(){s.call(t,window.event)}))},trackLoadProgress:function(e){if(e.settings.preload){var t,a,e=e,n=/(ipod|iphone|ipad)/i.test(navigator.userAgent);t=setInterval(function(){e.element.readyState>-1&&(n||e.init.apply(e)),e.element.readyState>1&&(e.settings.autoplay&&e.play.apply(e),clearInterval(t),a=setInterval(function(){e.loadProgress.apply(e),e.loadedPercent>=1&&clearInterval(a)}))},10),e.readyTimer=t,e.loadTimer=a}},purge:function(e){var t,a=e.attributes;if(a)for(t=0;t<a.length;t+=1)"function"==typeof e[a[t].name]&&(e[a[t].name]=null);if(a=e.childNodes)for(t=0;t<a.length;t+=1)purge(e.childNodes[t])},ready:function(){return function(e){var t=window,a=!1,n=!0,s=t.document,i=s.documentElement,r=s.addEventListener?"addEventListener":"attachEvent",l=s.addEventListener?"removeEventListener":"detachEvent",o=s.addEventListener?"":"on",d=function(n){("readystatechange"!=n.type||"complete"==s.readyState)&&(("load"==n.type?t:s)[l](o+n.type,d,!1),!a&&(a=!0)&&e.call(t,n.type||n))},p=function(){try{i.doScroll("left")}catch(e){return void setTimeout(p,50)}d("poll")};if("complete"==s.readyState)e.call(t,"lazy");else{if(s.createEventObject&&i.doScroll){try{n=!t.frameElement}catch(c){}n&&p()}s[r](o+"DOMContentLoaded",d,!1),s[r](o+"readystatechange",d,!1),t[r](o+"load",d,!1)}}}()}},a[t]=function(e,t){this.element=e,this.wrapper=e.parentNode,this.source=e.getElementsByTagName("source")[0]||e,this.mp3=function(e){var t=e.getElementsByTagName("source")[0];return e.getAttribute("src")||(t?t.getAttribute("src"):null)}(e),this.settings=t,this.loadStartedCalled=!1,this.loadedPercent=0,this.duration=1,this.playing=!1},a[t].prototype={updatePlayhead:function(){var e=this.element.currentTime/this.duration;this.settings.updatePlayhead.apply(this,[e])},skipTo:function(e){this.element.currentTime=this.duration*e,this.updatePlayhead()},skipToTime:function(e){this.element.duration?(this.element.currentTime=e+.1,this.updatePlayhead()):this.skiptime=e},load:function(t){this.loadStartedCalled=!1,this.source.setAttribute("src",t),this.element.load(),this.mp3=t,a[e].events.trackLoadProgress(this)},loadError:function(){this.settings.loadError.apply(this)},init:function(){this.settings.init.apply(this)},loadStarted:function(){return this.element.duration?(this.duration=this.element.duration,this.updatePlayhead(),this.settings.loadStarted.apply(this),void(this.skiptime&&(this.skipToTime(this.skiptime),this.skiptime=0))):!1},loadProgress:function(){if(null!=this.element.buffered&&this.element.buffered.length){this.loadStartedCalled||(this.loadStartedCalled=this.loadStarted());var e=this.element.buffered.end(this.element.buffered.length-1);this.loadedPercent=e/this.duration,this.settings.loadProgress.apply(this,[this.loadedPercent])}},playPause:function(){this.playing?this.pause():this.play()},play:function(){var t=/(ipod|iphone|ipad)/i.test(navigator.userAgent);t&&0==this.element.readyState&&this.init.apply(this),this.settings.preload||(this.settings.preload=!0,this.element.setAttribute("preload","auto"),a[e].events.trackLoadProgress(this)),this.playing=!0,this.element.play(),this.settings.play.apply(this)},pause:function(){this.playing=!1,this.element.pause(),this.settings.pause.apply(this)},setVolume:function(e){this.element.volume=e},trackEnded:function(){this.skipTo.apply(this,[0]),this.settings.loop||this.pause.apply(this),this.settings.trackEnded.apply(this)}};var n=function(e,t){var a=[];if(t=t||document,t.getElementsByClassName)a=t.getElementsByClassName(e);else{var n,s,i=t.getElementsByTagName("*"),r=new RegExp("(^|\\s)"+e+"(\\s|$)");for(n=0,s=i.length;s>n;n++)r.test(i[n].className)&&a.push(i[n])}return a.length>1?a:a[0]}}("audiojs","audiojsInstance",this);!function(){function n(n){this.t=n}function r(n){return new Option(n).innerHTML.replace(/"/g,"&quot;")}function t(n,r){for(var t=r.split(".");t.length;){if(!(t[0]in n))return!1;n=n[t.shift()]}return n}function e(n,o){return n.replace(i,function(n,r,i,u,f,a,c,s,l,p,v){var _,h=t(o,u),y="";if(!i&&(f&&(a||(c=t(o,c)||c),h="=="===f&&h==c||">="===f&&h>=c||">"===f&&h>c||"<="===f&&c>=h||"<"===f&&c>h),h))return e(l,o);if(!h)return"!"==i?e(s,o):p?e(v,o):"";if("@"==i){n=o._key,r=o._val;for(_ in h)h.hasOwnProperty(_)&&(o._key=_,o._val=h[_],y+=e(s,o));return o._key=n,o._val=r,y}return""}).replace(u,function(n,e,i){var u=t(o,i);return u||0===u?"%"==e?r(u):u:""})}var i=/\{\{(([@!]?)([^\s=><]+?))(?:([=><]{1,2})(["']?)([^"'\{\}\s]+?)\5)?\}\}(([\s\S]+?)(\{\{:\1\}\}([\s\S]+?))?)\{\{\/\1\}\}/g,u=/\{\{([=%])(.+?)\}\}/g;n.prototype.render=function(n){return e(this.t,n)},window.tjs=n}();!function(t){var e=0,n=[],i=function(){if(!e){var t=n.shift();t&&t()}},a={},f={left:"<%",right:"%>",path:"/tpl/",name:"main",ext:".html",cache:!0,data:{},back:t.noop};t.ejsSetup=function(e){t.extend(f,e)},t.ejsTpl=function(e,n){if(n){var i={};if(e.indexOf()>=0)i[e]=n;else for(var s,l=new RegExp(f.left+"[ \\t]*template[ \\t]*(\\w*?)[ \\t]*"+f.right+"\\s*([\\s\\S]*?)\\s*"+f.left+"/[ \\t]*template[ \\t]*"+f.right,"g");null!==(s=l.exec(n));)i[e+"."+s[1]]=s[2];e=i}t.extend(a,e)},t.ejs=function(s){s=t.extend({},f,s),s.cache||delete a[s.name],!s.tpl||a[s.name]&&s.cache||(a[s.name]=s.tpl);var l=new RegExp(s.left+"[ \\t]*"),r=new RegExp("[ \\t]*"+s.right),u=function(e,n){e=e.split(".",1)[0],t.get(s.path+e+s.ext,function(t){for(var i,f=new RegExp(s.left+"[ \\t]*template[ \\t]*(\\w*?)[ \\t]*"+s.right+"\\s*([\\s\\S]*?)\\s*"+s.left+"/[ \\t]*template[ \\t]*"+s.right,"g");null!==(i=f.exec(t));)a[e+"."+i[1]]=i[2];n()})},c=function(e,n){var i,f,s,p,o=function(){var u,h,g,m=function(t){i.push(t.join("")),h[1]&&i.push(h[1]),o()};for(i||(i=[],f=a[e].split(l),s=0,p=f.length);p>s;)if(u=f[s++],h=u.split(r),h.length>1||-1!==u.indexOf(r)){switch(h[0].charAt(0)){case":":return g=t.trim(h[0].substr(1)),void c(0===g.indexOf(".")?e.split(".",1)[0]+g:g,m);case"#":break;default:i.push(h[0])}h[1]&&i.push(h[1])}else i.push(h[0]);a[e]=i,n(i)};a[e]?setTimeout(function(){t.isArray(a[e])?n(a[e]):o()},0):u(e,o)};n.push(function(){e=setTimeout(function(){e=0,i()},5e3),c(s.name,function(t){var n=new tjs(t.join(""));s.back(n.render(s.data)),e&&(clearTimeout(e),e=0),i()})}),i()}}(jQuery);!function(e){var t,n={unknow:gettext("Unknow error"),wrong:gettext("Illegal"),require:gettext("Can not be empty"),currency:gettext("Must be a currency type, two decimal places"),than0cur:gettext("Must be greater than 0 Currency"),number:gettext("Must be non-negative integers"),integer:gettext("Must be an integer"),"double":gettext("Must be a real number"),english:gettext("Must be in English"),chinese:gettext("Must be Chinese"),unsafe:gettext("Including unsafe characters"),than0num:gettext("Must be an integer greater than zero"),than0double:gettext("Must be greater than zero"),limit:[gettext("%(0)s has been filled words, at least %(1)s characters"),gettext("%(0)s has been filled words, words up to %(2)s"),gettext("%(0)s has been filled words, must between [%(1)s, %(2)s] words in")],limitb:[gettext("A two-byte characters, %(0)s has been filled bytes, at least one byte of %(1)s"),gettext("A two-byte characters, have filled %(0)s bytes, up to %(2)s bytes"),gettext("A two-byte characters, have filled %(0)s bytes must be [%(1)s, %(2)s] bytes between")],group:[gettext("Has selected %(0)s items to select at least %(1)s items"),gettext("Has selected %(0)s items, select up to %(2)s items"),gettext("%(0)s item has been selected, you must select [%(1)s, %(2)s] items")],range:[gettext("Not be less than %(1)s"),gettext("Not be greater than %(2)s"),gettext("Must be in the [%(1)s, %(2)s] range"),gettext("Must be a number")],date:[gettext("Illegal"),gettext("Too small, must be [%(1)s %(2)s] range"),gettext("Too large, must be in [%(1)s, %(2)s] range")],repeat:gettext("Fill two inconsistent")},r={require:/\S+/,email:/^\w+([\-+.]\w+)*@\w+([\-.]\w+)*\.\w+([\-.]\w+)*$/,phone:/^(?:\(?[0\+]\d{2,3}\)?)[\s\-]?(?:(?:\(0{1,3}\))?\d{0,4})[\s\-](?:[\d]{7,8}|[\d]{3,4}[\s\-][\d]{3,4})(?:\-\d{1,4})?$/,mobile:/^(?:\(?[0\+]?\d{1,3}\)?)[\s\-]?(?:0|\d{1,4})[\s\-]?(?:(?:1\d{10})|(?:\d{7,8}))$/,phonecode:/(?:^\(?[0\+]\d{2,3}\)$)|(?:^(?:\(0{1,3}\))?\d{0,4}$)/,phonenum:/(?:^[\d]{7,8}$)|(?:^[\d]{3,4}[\s\-][\d]{3,4}$)/,phoneext:/^\d{1,4}$/,url:/^https?:\/\/[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@\[\]\':+!]*([^<>\"\"])*$/,currency:/^[\-\+]?\d+(\.\d\d?)?$/,than0cur:/^\d+(\.\d\d?)?$/,number:/^\d+$/,than0num:/^[1-9]\d*$/,than0double:/^[1-9]\d*(\.\d+)?$/,zip:/^\d{6}$/,integer:/^[\-\+]?\d+$/,"double":/^[\-\+]?\d+(\.\d+)?$/,english:/^[A-Za-z]+$/,chinese:/^[\u0391-\uFFE5]+$/,unsafe:/^(([A-Z]*|[a-z]*|\d*|[\-_\~!@#\$%\^&\*\.\(\)\[\]\{\}<>\?\\\/\'\"]*)|.{0,5})$|\s/,limit:function(e,n,r){var s,a,i;return e=""===e?0/0:Number(e),isNaN(e)?3:(n=""===n?0/0:Number(n),r=""===r?0/0:Number(r),a=isNaN(n),i=isNaN(r),s=a&&i?!1:a?1:i?0:2,n=n||0,r=r||Number.MAX_VALUE,t=[e,n,r],e>=n&&r>=e||s)},compare:function(e,t,n){switch(t){case"!=":return e!==n;case">":return e>n;case">=":return e>=n;case"<":return n>e;case"<=":return n>=e;default:return e===n}},date:function(n,r,s){var a,i,u,l,o,d=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/,g=e.trim(n).match(d);return g?(a=new Date,i=parseInt(g[1],10),u=parseInt(g[3],10)-1,l=parseInt(g[4],10),a.setFullYear(i,u,l),a.getFullYear()!==i||a.getMonth()!==u||a.getDate()!==l?0:(t=[n,r,s],r&&(g=r.match(d),g&&(o=new Date,i=parseInt(g[1],10),u=parseInt(g[3],10)-1,l=parseInt(g[4],10),o.setFullYear(i,u,l),a.getTime()<o.getTime()))?1:s&&(g=s.match(d),g&&(o=new Date,i=parseInt(g[1],10),u=parseInt(g[3],10)-1,l=parseInt(g[4],10),o.setFullYear(i,u,l),a.getTime()>o.getTime()))?2:!0)):0}},s={limit:function(e,t,n,r){return n[0]=n[0].length,["limit",n,r.limit]},limitb:function(e,t,n,r){return n[0]=n[0].replace(/[^\x00-\xff]/g,"xx").length,["limit",n,r.limitb]},range:function(e,t,n,r){return["limit",n,r.range]},repeat:function(t,n,r,s){var a=e(":input[name="+r[1]+"]",t);return r[2]=a.attr("val")||a.val(),r[1]="==",["compare",r,s.repeat]},group:function(t,n,r,s){return r[0]=e(":checkbox[name="+n[0].name+"]:checked",t).length,["limit",r,s.group]}},a={};e.validatorSetup=function(t){t.rule&&e.extend(r,t.rule),t.val&&e.extend(a,t.val),t.func&&e.extend(s,t.func),t.lang&&e.extend(n,t.lang)},e.validator=function(s,a,i){var u=r[s],l=-1;return t=[],u&&(l=e.isFunction(u)?u.apply(u,a):u.test(a[0])),-1===l?[-1,n.unknow]:!0!==l?[!1,interpolate(e.isArray(i)&&i[l]?i[l]:i||n.wrong,t,!0)]:!0},e.fn.validator=function(t){var r=[],i=[];return this.each(function(){var u,l,o,d,g,c,h,b,m,p,x=this,f=e(x),w=f.attr("vd");if(!f.is(":input[name]")||f.is(":hidden,:disabled,input:submit,:radio,:checkbox")&&!w)return void i.push(x);for(d=(w||"").split("#"),g=d[1],d=(d[0]||"").split("|"),p=function(){return(g&&e.isFunction(f[g])?f[g]()[0]:g&&e("*[vw="+g+"]","g"===g.substr(0,1)?null:t)[0])||x},o=0;o<d.length;o++){if(h=(d[o]||"").split("/"),l=h[0]||"require",u=a[l]?a[l](f):f.attr("val")||f.val(),"0"===f.attr("req")&&!u)return void i.push(x);if(!u)return void r.push([p(),[!1,n.require]]);h[0]=u,s[l]?(b=s[l](t,f,h,n),l=b[0],h=b[1],m=b[2]):m=n[l],h=e.validator(l,h,m),!0!==h&&(c||(c=[p()]),c.push(h))}c?r.push(c):i.push(p())}),[r,i]}}(jQuery);!function(t){var e=t(document),o=t("body"),i={position:"auto",mod:"mod",cls:"gtl",queue:"tooltip",dat:"dragstatic",delay:0,fixps:0,hide:200,sticky:0,own:e},n={},s=function(t,e){t.offset({top:Math.round(e.top),left:Math.round(e.left)})},l=function(e){if(!n[e]){var o=t('<div style="display:none;"><div class="hd"></div><div class="bd"></div><div class="ft bb"></div></div>');n[e]={d:o,bd:t(".bd",o),ft:t(".ft",o),un:1}}return n[e]};t.tooltipSetup=function(e){t.extend(i,e)},t.fn.tooltip=function(n){var d,f=this[0],u=t(f);if(n=t.extend({},i,n),f&&(n.dragsh||!u.data(n.dat))&&(n.title&&(n.html=f.getAttribute("title")),n.html)){n.title&&(f.removeAttribute("title"),u.one("mouseout",function(){f.setAttribute("title",n.html)}));var a=n.queue,c=l(a),r=c.d,p=c.bd,h=c.ft,m=n.fixps,b=function(){var o="."+a;e.unbind(o),c.sd.unbind(o),p.unbind(o),u.unbind(o),t(n.own).unbind(o),c.sd=0},y=function(){n.con?t.isFunction(n.con)?n.con(u).append(r):n.con.append(r):o.append(r);var i=function(){return d?(clearTimeout(d),void(d=0)):(c.ly&&clearTimeout(c.ly),void(c.ly=setTimeout(function(){c.ly=0,r.fadeOut(function(){c.sd&&c.un?b():c.un=1})},n.hide)))},l=function(){var t,e=n.vcon||o,d=n.con||o,f=d.innerWidth(),a=d.innerHeight(),c=d.offset(),b=e.offset(),y=m?{left:m[0],top:m[1]}:u.offset(),v=p.outerWidth(),g=p.outerHeight(),w=h.height(),T=h.width(),k=m?m[2]:u.outerWidth(),M=m?m[3]:u.outerHeight();switch("auto"===n.position&&(h[0].className="ft bb",n.position=g+w>y.top-b.top?"bottom":"top"),n.position){case"top":h[0].className="ft bb",t=y.left+v-f-c.left+5,t>0?(v>f&&(t=y.left-c.left),s(r,{left:y.left-t,top:y.top-g-w}),h.css({left:Math.round(t+5)})):s(r,{left:y.left,top:y.top-g-w}),p.outerHeight()-g>5&&l();break;case"bottom":h[0].className="ft bt",t=y.left+v-f-c.left+5,t>0?(v>f&&(t=y.left-c.left),s(r,{left:y.left-t,top:y.top+M+w}),h.css({left:Math.round(t+5)})):s(r,{left:y.left,top:y.top+M+w});break;case"right":h[0].className="ft bl",t=y.top+g-a-c.top+5,t>0?(s(r,{left:y.left+k+T,top:y.top-t}),h.css({top:Math.round(t+5)})):s(r,{left:y.left+k+T,top:y.top});break;case"left":h[0].className="ft br",t=y.top+g-a-c.top+5,t>0?(s(r,{left:y.left-v-T,top:y.top-t}),h.css({top:Math.round(t+5)})):s(r,{left:y.left-v-T,top:y.top});break;default:return void i()}},y=function(){n.sticky||(u.bind("mouseout."+a,i),p.bind("mouseover."+a,function(){c.ly?(clearTimeout(c.ly),c.ly=0):(c.un=0,r.stop(!0,!0))}),e.bind("mousemove."+a,function(t){var e=t.target;e===f||e===r[0]||u.has(e)[0]||r.has(e)[0]||i()})),("number"!=typeof n.sticky||n.sticky<2)&&e.bind("mousedown."+a,function(t){var e=t.target;e===f||u.has(e)[0]||i()}),e.bind("act."+a,i),n.dragsh||u.bind("drag."+a,function(t,e){"start"===e&&i()}),u.bind("hidetip."+a,i),t(n.own).bind("empty."+a,i)};return c.sd&&c.sd[0]===f?(m?l():"string"==typeof n.html?p[0].innerHTML=n.html:p.empty().append(t(n.html)),r[0].className=n.mod+" "+n.cls,c.ly?(clearTimeout(c.ly),c.ly=0,b()):(c.un=0,r.stop(!0,!0).fadeIn()),y(),void(m||l())):void(d=setTimeout(function(){d=0,r[0].className=n.mod+" "+n.cls,n.toSelect&&f.select(),r.css(n.width?{width:n.width}:{width:"auto"}),c.ly&&(clearTimeout(c.ly),c.ly=0),r.stop(!0,!0).css({left:-99999,top:0}).hide().fadeIn(),"string"==typeof n.html?p[0].innerHTML=n.html:p.empty().append(t(n.html)),h.removeAttr("style"),("left"===n.position||"right"===n.position)&&(h[0].className="ft bl"),l(),c.sd=u,y()},n.delay))};n.toFocus?setTimeout(function(){f.focus(),y()},9):y()}return this}}(jQuery);!function(t){var r=/["\\\x00-\x1f\x7f-\x9f]/g,n={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},e=function(t){return t.match(r)?'"'+t.replace(r,function(t){var r=n[t];return"string"==typeof r?r:(r=t.charCodeAt(),"\\u00"+Math.floor(r/16).toString(16)+(r%16).toString(16))})+'"':'"'+t+'"'};t.toJSON=function(r){if("object"==typeof JSON&&JSON.stringify)return JSON.stringify(r);var n=typeof r;if(null===r)return"null";if("undefined"===n)return void 0;if("number"===n||"boolean"===n)return r+"";if("string"===n)return e(r);if("object"===n){if("function"==typeof r.toJSON)return t.toJSON(r.toJSON());if(r.constructor===Date){var o=r.getUTCMonth()+1;10>o&&(o="0"+o);var i=r.getUTCDate();10>i&&(i="0"+i);var f=r.getUTCFullYear(),u=r.getUTCHours();10>u&&(u="0"+u);var a=r.getUTCMinutes();10>a&&(a="0"+a);var c=r.getUTCSeconds();10>c&&(c="0"+c);var g=r.getUTCMilliseconds();return 100>g&&(g="0"+g),10>g&&(g="0"+g),'"'+f+"-"+o+"-"+i+"T"+u+":"+a+":"+c+"."+g+'Z"'}if(r.constructor===Array){var l,s=[];for(l=0;l<r.length;l++)s.push(t.toJSON(r[l])||"null");return"["+s.join(",")+"]"}var v,S=[];for(v in r){var y;if(n=typeof v,"number"===n)y='"'+v+'"';else{if("string"!==n)continue;y=e(v)}if("function"!=typeof r[v]){var p=t.toJSON(r[v]);S.push(y+":"+p)}}return"{"+S.join(", ")+"}"}}}(jQuery);!function(e){var t={space:"storage",dn:"storage"},a=window.localStorage,o=1;if(!a){a=document.createElement("INPUT"),a.type="hidden",a.style.display="none",a.addBehavior("#default#userData"),document.body.appendChild(a);try{a.load(t.space),o=2}catch(d){document.body.removeChild(a),a=0,o=0}}e.storageSetup=function(a){e.extend(t,a)},e.storage=function(){if(!a)return null;var d,n,r,s=arguments;return"object"==typeof s[0]?(d=e.extend({},t,s[0]),n=s[1]||d.dn,r=s[2]):(d=t,n=s[0]||d.dn,r=s[1]),"undefined"==typeof r?1===o?a.getItem(d.space+"."+n):(a.load(d.space),a.getAttribute(n)):void(null===r?1===o?a.removeItem(d.space+"."+n):(a.load(d.space),a.removeAttribute(n),a.save(d.space)):1===o?a.setItem(d.space+"."+n,r):(a.load(d.space),a.setAttribute(n,r),a.save(d.space)))}}(jQuery);!function(e){var t=e("body"),r=e(document),o=e(window),i=(new Date).getTime(),n=void 0!==document.ontouchend,s="drogstatic",a={own:r,moveOnEnd:1,dropTag:"*",dropRange:1,dat:"dragstatic",groups:["jquerydd"]};e.dragSetup=function(t){e.extend(a,t)},e.fn.drag=function(d){return d=e.extend({},a,d),this.each(function(){var a,g,l,p,u,c,h,f,v,y,m,x,b,w,z,M,j,T,C,q,E,R,H,L,W=this,k=e(W),A=e(d.handle?e.isFunction(d.handle)?d.handle(W)||W:d.handle:W),D="drag"+i,F=0;i++,d.scroll&&(g=k.outerHeight(!0),l=k.outerWidth(!0)),y=function(t){if(!(e(t.target).is(":input")||d.ext&&(e.isFunction(d.ext)?d.ext(W):d.ext)===t.target)){d.movecls&&A.addClass(d.movecls),R=k.css("position"),"static"===R&&k.css("position","relative"),E="fixed"===R?1:0;var i=n?t.originalEvent.touches[0].pageX:t.pageX,s=n?t.originalEvent.touches[0].pageY:t.pageY;if(d.scroll)c=-i-d.scroll.scrollLeft(),h=-s-d.scroll.scrollTop();else if(a=k.offset(),d.size?(l=k.width(),g=k.height(),p=i-l,u=s-g,c=a.left,h=a.top):E?(c=i-a.left+o.scrollLeft(),h=s-a.top+o.scrollTop()):(c=i-a.left,h=s-a.top),d.proxy){var y=k.outerWidth(),z=k.outerHeight();b=e('<div style="position:absolute;width:'+y+"px;height:"+z+'px;z-index:99999;"></div>').css(A.offset()),w=b,f=y-l,v=z-g}else f=0,v=0,w=k;r.bind((n?"touchmove.":"mousemove.")+D,x).bind((n?"touchend.":"mouseup.")+D,m),A[0].setCapture?(A.bind("losecapture."+D,m),A[0].setCapture()):o.blur(m),F=1,k.data(d.dat,1),t.preventDefault()}},x=function(o){if(window.getSelection?window.getSelection().removeAllRanges():document.selection.empty(),1===F)return F=2,d.cancelFirstClick&&A.one("click",function(){return!1}),o.type="drag",o.drag=M,o.target=W,k.trigger(o,"start"),void(d.scroll||(d.proxy&&(M=e.isFunction(d.proxy)?d.proxy(W):d.proxy,t.append(b),M?b.append(M):M=b),d.region&&(a=d.region.offset()||{top:0,left:0},j=a.top,T=a.left,C=d.region.width(),q=d.region.height(),H=w.outerWidth(),L=w.outerHeight()),z=[],e(d.dropTag+"[jquerydd]:visible",d.region||r).each(function(){var t,r,o,i=this.getAttribute("jquerydd"),n=d.groups;for(t=0,r=n.length;r>t;t++)if(W!==this&&i.indexOf("|"+n[t]+"|")>=0){o=e(this),o.removeData(s),z.push(o);break}}),z[0]?(M=M||w,a=M.offset(),M=[M,M.outerWidth(),M.outerHeight()]):M=0));o.drag=M;var i=n?o.originalEvent.touches[0].pageX:o.pageX,y=n?o.originalEvent.touches[0].pageY:o.pageY;if(d.scroll){var m=g-d.scroll.height(),x=-y-h;m>0&&(0>x&&(x=0),d.scroll.scrollTop(x)),m=l-d.scroll.width(),x=-i-c,m>0&&(0>x&&(x=0),d.scroll.scrollLeft(x))}else{if(d.size){var R=i-p,D=y-u;R=d.size[0]&&R<d.size[0]?d.size[0]:d.size[2]&&R>d.size[2]?d.size[2]:R,D=d.size[1]&&D<d.size[1]?d.size[1]:d.size[3]&&D>d.size[3]?d.size[3]:D,R=R>0?R:0,D=D>0?D:0,d.region&&(c+R+f>T+C&&(R=T+C-c-f),h+D+v>j+q&&(D=j+q-h-v)),w.css({width:Math.round(R),height:Math.round(D)})}else{var S=i-c,X=y-h;d.region&&(T>S?S=T:S+H>T+C&&(S=T+C-H),j>X?X=j:X+L>j+q&&(X=j+q-L)),E?w.css({left:Math.round(S),top:Math.round(X)}):w.offset({left:Math.round(S),top:Math.round(X)})}if(M){var Y,O,Q,B,G,I,J;for(d.mousehit?(O=i-r.scrollTop(),Q=y-r.scrollLeft(),B=1,G=1):(Y=M[0].offset(),O=Y.left,Q=Y.top,B=M[1]*d.dropRange,G=M[2]*d.dropRange),I=0,J=z.length;J>I;I++){var K=z[I];if(K.is(":visible")&&K[0]!==W){var N=K.data(s),P=K.offset(),U=P.left,V=P.top,Z=K.outerWidth()*d.dropRange,$=K.outerHeight()*d.dropRange;Q>V+$||V>Q+G||O>U+Z||U>O+B?N&&(o.type="drag",o.target=W,k.trigger(o,["exit",K[0]]),o.type="drop",o.target=K[0],K.trigger(o,["exit",W]),K.removeData(s)):N?(o.type="drag",o.target=W,k.trigger(o,["over",K[0]]),o.type="drop",o.target=K[0],K.trigger(o,["over",W])):(K.data(s,1),o.type="drag",o.target=W,k.trigger(o,["enter",K[0]]),o.type="drop",o.target=K[0],K.trigger(o,["enter",W]))}}}}o.type="drag",o.target=W,k.trigger(o,"move")},m=function(e){if(r.unbind("."+D),A[0].releaseCapture?(A.unbind("losecapture."+D),A[0].releaseCapture()):o.unbind("blur",m),d.movecls&&A.removeClass(d.movecls),d.resetposition&&"static"===R&&k.css({position:R,top:0,left:0}),k.data(d.dat,0),e.drag=M,F>1){if(!d.scroll&&(d.proxy&&d.moveOnEnd&&(d.size?k.css({width:Math.round(w.width()-f),height:Math.round(w.height()-v)}):(a=w.offset(),E?k.css({left:a.left-o.scrollLeft(),top:a.top-o.scrollTop()}):k.offset(a))),d.toper&&(a=k.position(),k.css({top:Math.round(a.top/d.toper.height()*100)+"%",left:Math.round(a.left/d.toper.width()*100)+"%"})),M)){var t,i;for(a=1,t=0,i=z.length;i>t;t++){var n=z[t];if(n.data(s)&&n.is(":visible")){e.type="drag",e.target=W,k.trigger(e,["hit",n[0]]),e.type="drop",e.target=n[0],n.trigger(e,["hit",W]),a=0;break}}a&&(e.type="drag",e.target=W,k.trigger(e,["miss"]))}e.type="drag",e.target=W,k.trigger(e,"stop"),d.proxy&&w&&(w.remove(),w=0)}M=0,b&&b.remove(),b=0,F=0},A.bind((n?"touchstart.":"mousedown.")+D,y),k.one("removedrag",function(e){A.unbind("."+D),m(e)})})};var d={groups:["jquerydd"]};e.dropSetup=function(t){e.extend(d,t)},e.fn.drop=function(t){return t=e.extend({},d,t),this.each(function(){var r=this,o=e(r);r.setAttribute("jquerydd","|"+t.groups.join("|")+"|"),o.one("removedrop",function(){r.removeAttribute("jquerydd")})})}}(jQuery);!function(t){var e,i,n,o=t(document),d=window,c=t(d),l=t.cm,s=void 0!==document.ontouchend,a={},r=function(){var t,e={};return s?(e.x=d.pageXOffset,e.y=d.pageYOffset,e.w=d.innerWidth,e.h=d.innerHeight):(t=c.offset(),t?(e.x=t.left,e.y=t.top):(e.x=0,e.y=0),e.w=c.width(),e.h=c.height()),e},f={cls:"gdlg",cvs:"gcv",con:t("body"),movecls:"cumv",drag:"drag",isdrag:1,ln:{title:gettext("Dialog"),alert:gettext("System message"),confirm:gettext("Are you sure"),yes:gettext("Sure"),no:gettext("Cancel"),save:gettext("Save"),nosave:gettext("No save"),close:gettext("Close")},xm:t.xm||{},bj:t.bj||{},bjs:l&&l.bjs?l.bjs:function(){},ubj:l&&l.ubj?l.ubj:function(){},load:l&&l.load?l.load:function(){},html:"",url:"",cache:!1,data:null,model:!0,fixedcenter:!0,ico:[],defico:1,back:t.noop,zIndex:1e3,animate:function(t,e,i){var n,o,d=t[0],c=t[1],l=t[2];switch(e){case"show":c&&c.fadeIn(),d.css("opacity",0),o=r(),n={left:Math.round("number"==typeof l.left&&l.left>=0?l.left:"number"==typeof l.right&&l.right>=0?o.w-d.width()-l.right:o.x+(o.w-d.width())/2),top:Math.round("number"==typeof l.top&&l.top>=0?l.top:"number"==typeof l.bottom&&l.bottom>=0?o.h-d.height()-l.bottom:o.y+(o.h-d.height())/2)},d[l.sf](n).animate({opacity:1},function(){try{d[0].style.removeAttribute("filter")}catch(t){}i&&i()});break;case"hide":c&&c.fadeOut(function(){c.remove(),c=0}),d.fadeOut(i)}},own:o};n=f.zIndex,t.dialogSetup=function(e){t.extend(f,e),n=f.zIndex},t.dialogGetActId=function(){return e},t.dialogIsExist=function(t){return a[t]},t.dialog=function(d){function l(){var t;d.width&&(t=.9*d.con.width(),u.css({width:t<d.width?t:d.width})),d.height&&(t=.8*d.con.height(),v.css({height:t<d.height?t:d.height}))}var u,h,v,g,m,b="dialog"+(new Date).getTime();if(d=t.extend({},f,d),d.html||d.url){d.own=t(d.own),i=b,u=t('<div class="'+d.cls+'" id="'+b+'" style="z-index:'+n+';"><div class="fhd"><h1><span>'+(d.title||d.ln.title)+'</span></h1></div><div class="fbt"></div><div class="fbd"><div class="bdx"><div class="cte" id="frame-dialog"></div></div></div><div class="fft"><div><p></p></div></div></div>'),u.css({top:-9999,left:-9999}),d.model&&(h=t('<div class="'+d.cvs+'" style="z-index:'+n+';"></div>'),s&&h.css({position:"absolute",width:document.documentElement.offsetWidth,height:document.documentElement.offsetHeight}),d.con.append(h)),a[b]=[u,h,d],d.con.append(u),d.sf="fixed"===u.css("position")?"css":"offset",s&&u.css("position","absolute"),e=b,d.bridge&&u.data("bridge",d.bridge),v=t("div.cte",u),m=function(i,o){var c=function(){var o,d,c,l=0;if(i.empty(),i.remove(),delete a[b],t.isEmptyObject(a))n=f.zIndex,e=null;else{for(o in a)d=Math.max(l,a[o][0].css("zIndex")),d>l&&(l=d,c=a[o]);e=c[0].attr("id")}};d.animate(a[b],o||"hide",c)},g=function(){var i,l,f=t("div.fhd",u),g=function(){d.ubj(v),c.unbind("."+b),o.unbind("."+b)},p=function(){!1!==d.back("close")&&(d.own[0]!==o[0]&&d.own.triggerHandler("dialog",["close",b]),g(),m(u))};for(i=u.children("div.fbt"),l=0;l<d.ico.length;l++)t('<em class="'+d.ico[l][0]+'" title="'+d.ico[l][1]+'">'+d.ico[l][1]+"</em>").appendTo(i).click(d.ico[l][2]);d.defico&&t('<em class="cls" title="'+d.ln.close+'">'+d.ln.close+"</em>").appendTo(i).click(p),!1!==d.back("show")&&d.own[0]!==o[0]&&d.own.triggerHandler("dialog",["show",b]),d.animate(a[b],"show"),d.isdrag&&u[d.drag]&&u[d.drag]({handle:f,region:c,movecls:d.movecls,own:d.own}),d.fixedcenter&&c.bind("resize."+b,function(){var t=r();u[d.sf]({left:Math.round(t.x+(t.w-u.width())/2),top:Math.round(t.y+(t.h-u.height())/2)})}),s&&u.bind("orientationchange",function(){var t=r();u[d.sf]({left:Math.round(t.x+(t.w-u.width())/2),top:Math.round(t.y+(t.h-u.height())/2)}),d.model&&h.css({width:document.documentElement.offsetWidth,height:document.documentElement.offsetHeight})}),o.bind("dialog."+b,function(t,e,i){"close"===e&&i===b&&a[i]&&p()}),u.bind("close",p).mousedown(function(){b!==e&&(n++,u.css("zIndex",n),e=b)}).click(function(t){"close"===t.target.getAttribute("t")&&p()})};var p=function(){var e=v.children("div:first").attr("tit");e&&(t("div.fhd span",u)[0].innerHTML=e)};return l(),c.bind("resize."+b,l),d.html?("object"==typeof d.html?v.append(d.html):v[0].innerHTML=d.html,d.bjs(v),p(),g()):d.url&&d.load(d.url,{ct:v,data:d.data,cache:d.cache,success:function(){p(),g()},error:function(){m(u)}}),b}},function(){var e,i=0,n=function(i){var n=e;t(i).bind("empty",function(){delete f.xm[n],delete f.bj[n]}).find("input[t=close]").focus()};t.alert=function(o,d){d=d||{};var c=d.ln||f.ln;return e="alert"+i,i++,f.xm[e]=n,f.bj[e]=e,t.dialog({title:d.title||c.alert,html:'<div class="mod galt" id="'+e+'"><div class="hd"></div><div class="bd"><table class="tb"><tr><td>'+o+'</td></tr></table></div><div class="ft"><input type="button" t="close" value="'+c.yes+'"/></div></div>'})}}(),function(){var e,n,d=0,c=function(d){var c,l=t(d),s=e,a=i,r=n;l.bind("empty",function(){r&&(r("close"),r=null),delete f.xm[s],delete f.bj[s]}).find("div.ft").click(function(e){var i=t(e.target);return i.is("input[t]")?(c(i.attr("t")),!1):void 0}),l.find("input[t]:eq("+l.attr("focus")+")").focus(),c=function(t){r&&(r(t),r=null),o.triggerHandler("dialog",["close",a])}};t.confirm=function(i,o,l){l=t.extend({act:"yes|no",focus:0,ln:f.ln},l);var s,a,r=l.act.split("|"),u=[];for(n=o,e="confirm"+d,d++,s=0;s<r.length;s++)a=r[s],u.push('<input type="button" t="'+a+'" value="'+l.ln[a]+'"/>');return f.xm[e]=c,f.bj[e]=e,t.dialog({title:l.title||l.ln.confirm,html:'<div class="mod galt" id="'+e+'" focus="'+l.focus+'"><div class="hd coo"></div><div class="bd"><table class="tb"><tr><td>'+i+'</td></tr></table></div><div class="ft">'+u.join(" ")+"</div></div>"})}}()}(jQuery);!function(e){function t(t){var n=t||window.event,i=[].slice.call(arguments,1),l=0,s=0,o=0;return t=e.event.fix(n),t.type="mousewheel",n.wheelDelta&&(l=n.wheelDelta/120),n.detail&&(l=-n.detail/3),o=l,void 0!==n.axis&&n.axis===n.HORIZONTAL_AXIS&&(o=0,s=-1*l),void 0!==n.wheelDeltaY&&(o=n.wheelDeltaY/120),void 0!==n.wheelDeltaX&&(s=-1*n.wheelDeltaX/120),i.unshift(t,l,s,o),(e.event.dispatch||e.event.handle).apply(this,i)}var n=["DOMMouseScroll","mousewheel"];if(e.event.fixHooks)for(var i=n.length;i;)e.event.fixHooks[n[--i]]=e.event.mouseHooks;e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=n.length;e;)this.addEventListener(n[--e],t,!1);else this.onmousewheel=t},teardown:function(){if(this.removeEventListener)for(var e=n.length;e;)this.removeEventListener(n[--e],t,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}(jQuery);!function(t){function i(i,s){function e(t){window.getSelection?window.getSelection().removeAllRanges():document.selection.empty(),o.setScroll(n,0),h&&clearInterval(h),h=setInterval(function(){clearInterval(h),h=setInterval(function(){o.setScroll(n,0)},80)},300),t.preventDefault()}if(this.container=t(i),this.settings=s,this.timer=0,this.before={v:0,h:0},this.touch={},this.pressed=0,this.vslider=t("<div/>",{"class":"rollbar-handle"}),this.vpath=t("<div/>",{"class":"rollbar-path-vertical"}),this.hslider=t("<div/>",{"class":"rollbar-handle"}),this.hpath=t("<div/>",{"class":"rollbar-path-horizontal"}),this.sliders=this.vslider.add(this.hslider),this.upicon=t("<div/>",{"class":"rollbar-upicon"}).append("<em/>"),this.downicon=t("<div/>",{"class":"rollbar-downicon"}).append("<em/>"),this.container.css({position:"relative",overflow:"hidden"}).contents().filter(this.settings.contentFilter).wrapAll('<div class="rollbar-content"></div>'),this.content=this.container.children(".rollbar-content").css({position:"relative",top:0,left:0,overflow:"hidden"}),"horizontal"!==this.settings.scroll){if(this.container.prepend(this.vpath.append(this.vslider)),this.settings.showIcon){var h,n,o=this;this.container.prepend(this.upicon,this.downicon),this.bindEvent(this.upicon.find("em"),"mousedown",function(t){n=this.settings.wheelSpeed,e(t)}),this.bindEvent(this.downicon.find("em"),"mousedown",function(t){n=-this.settings.wheelSpeed,e(t)}),this.bindEvent(t(document),"mouseup."+this.settings.id,function(){h&&(clearInterval(h),h=0)})}}else"vertical"!==this.settings.scroll&&this.container.prepend(this.hpath.append(this.hslider));this.vpath.add(this.hpath).css({"z-index":this.settings.zIndex,opacity:0}),this.vslider.css({height:parseInt(this.container.height()/this.content.outerHeight(!0)*100,10)+"%",opacity:this.settings.sliderOpacity}),this.hslider.css({width:parseInt(this.container.width()/this.content.outerWidth(!0)*100,10)+"%",opacity:this.settings.sliderOpacity}),this.settings.sliderOpacity&&this.sliders.hover(this.fixFn(function(){this.sliders.stop().fadeTo(this.settings.sliderOpacityTime,1)}),this.fixFn(function(){this.pressed||this.sliders.stop().fadeTo(this.settings.sliderOpacityTime,this.settings.sliderOpacity)})),this.init(),this.pathSize(),this.checkScroll(),this.checkIcon(),this.settings.lazyCheckScroll>0&&setInterval(this.fixFn(function(){this.checkScroll(),this.pathSize()}),this.settings.lazyCheckScroll)}var s={id:"rollbar",scroll:"both",autoHide:!0,autoHideTime:"fast",lazyCheckScroll:0,blockGlobalScroll:!1,contentFilter:"*",sliderOpacity:.3,sliderOpacityTime:200,sliderOpacityDelay:1e3,wheelSpeed:100,touchSpeed:.3,pathPadding:"5px",keyScroll:100,scrollTime:500,scrollInterval:15,scrollEasing:"swing",zIndex:100,showIcon:!0,isFocus:0,onscroll:function(){}};i.prototype.checkIcon=function(){var t=this.settings.autoHideTime,i=this.content.position();this.vdiff>0?(i.top<-1?this.upicon.stop().animate({top:0},t):this.upicon.stop().animate({top:"-20px"},t),-i.top<this.vdiff-1?this.downicon.stop().animate({bottom:0},t):this.downicon.stop().animate({bottom:"-20px"},t)):(this.upicon.stop().animate({top:"-20px"},t),this.downicon.stop().animate({bottom:"-20px"},t))},i.prototype.checkScroll=function(){var t=this.settings.autoHideTime;this.vtrack=this.vpath.height()-this.vslider.height(),this.htrack=this.hpath.width()-this.hslider.width(),this.vdiff=this.content.height()-this.container.height(),this.hdiff=this.content.width()-this.container.width(),this.settings.autoHide&&(this.vdiff>0?this.vpath.fadeTo(t,1):this.vpath.fadeTo(t,0),this.hdiff>0?this.hpath.fadeTo(t,1):this.hpath.fadeTo(t,0))},i.prototype.pathSize=function(){var t=parseInt(this.settings.pathPadding,10),i=this.container.width(),s=this.container.height();this.vpath.css({top:t+"px",height:s-2*t+"px"}),this.hpath.css({left:t+"px",width:i-2*t+"px"}),this.vslider.css({height:parseInt(s/this.content.outerHeight(!0)*100,10)+"%"}),this.hslider.css({width:parseInt(i/this.content.outerWidth(!0)*100,10)+"%"})},i.prototype.scroll=function(t,i,s){var e=0,h=0;0>t&&(t=0),t>this.vtrack&&(t=this.vtrack),this.vslider.css("top",t+"px"),0>i&&(i=0),i>this.htrack&&(i=this.htrack),this.hslider.css("left",i+"px"),this.vdiff>0&&(h=t/this.vtrack,this.content.css("top",Math.round(-this.vdiff*h)),s&&t&&t!=this.vtrack&&(s.stopPropagation(),s.preventDefault())),this.hdiff>0&&(e=i/this.htrack,this.content.css("left",Math.round(-this.hdiff*e)),s&&i&&i!=this.htrack&&(s.stopPropagation(),s.preventDefault())),(this.before.v!=h||this.before.h!=e)&&("function"==typeof this.settings.onscroll&&this.settings.onscroll.call(this.container.get(0),h,e),this.before.v=h,this.before.h=e),this.checkIcon()},i.prototype.easeScroll=function(i,s){var e=0,h=Math.floor(this.settings.scrollTime/this.settings.scrollInterval),n=this.vslider.position().top,o=this.hslider.position().left,r=t.easing[this.settings.scrollEasing]||t.easing.linear;this.sliders.stop().fadeTo(this.settings.sliderOpacityTime,1),window.clearInterval(this.timer),this.timer=window.setInterval(this.fixFn(function(){this.scroll(n+r(e/h,e,0,1,h)*i,o+r(e/h,e,0,1,h)*s),++e>h&&(window.clearInterval(this.timer),this.sliders.stop().fadeTo(this.settings.sliderOpacityTime,this.settings.sliderOpacity))}),this.settings.scrollInterval)},i.prototype.fixFn=function(t,i){var s=this;return function(){t.apply(i||s,Array.prototype.slice.call(arguments))}},i.prototype.bindEvent=function(t,i,s,e){return t.bind(i,this.fixFn(s,e))},i.prototype.init=function(){var i=t(window.document);this.bindEvent(this.sliders,"mousedown",function(t){this.pressed=t.target===this.vslider.get(0)?1:2;var s=t.pageX,e=t.pageY,h=this.vslider.position().top,n=this.hslider.position().left;this.bindEvent(i,"mousemove."+this.settings.id,function(t){1==this.pressed?this.scroll(h+(t.pageY-e),n):this.scroll(h,n+(t.pageX-s))}),this.bindEvent(i,"selectstart."+this.settings.id,function(t){t.preventDefault()})}),this.bindEvent(i,"mouseup."+this.settings.id,function(t){1==this.pressed&&t.target!==this.vslider.get(0)?this.vslider.fadeTo(this.settings.sliderOpacityTime,this.settings.sliderOpacity):2==this.pressed&&t.target!==this.hslider.get(0)&&this.hslider.fadeTo(this.settings.sliderOpacityTime,this.settings.sliderOpacity),this.pressed=0,i.unbind("mousemove."+this.settings.id),i.unbind("selectstart."+this.settings.id)}),this.bindEvent(this.container,"touchstart",function(t){var i=t.originalEvent,s=i.changedTouches[0];this.touch.sx=s.pageX,this.touch.sy=s.pageY,this.touch.sv=this.vslider.position().top,this.touch.sh=this.hslider.position().left,this.sliders.stop().fadeTo(this.settings.sliderOpacityTime,1),this.settings.blockGlobalScroll&&(this.vdiff||this.hdiff)&&i.stopPropagation()}),this.bindEvent(this.container,"touchmove",function(t){var i=t.originalEvent,s=i.targetTouches[0];this.scroll(this.touch.sv+(this.touch.sy-s.pageY)*this.settings.touchSpeed,this.touch.sh+(this.touch.sx-s.pageX)*this.settings.touchSpeed,t),this.settings.blockGlobalScroll&&(this.vdiff||this.hdiff)&&(i.preventDefault(),i.stopPropagation())}),this.bindEvent(this.container,"touchend touchcancel",function(t){{var i=t.originalEvent;i.changedTouches[0]}this.sliders.stop().fadeTo(this.settings.sliderOpacityTime,this.settings.sliderOpacity),this.settings.blockGlobalScroll&&(this.vdiff||this.hdiff)&&i.stopPropagation()});var s=this.vpath.height(),e=this.hpath.width();this.doresize=function(){this.pathSize(),this.checkScroll(),this.vdiff<=0&&this.content.css("top",0),this.hdiff<=0&&this.content.css("left",0),this.scroll(Math.round(parseInt(this.vslider.css("top"),10)*this.vpath.height()/s),Math.round(parseInt(this.hslider.css("left"),10)*this.hpath.width()/e)),s=this.vpath.height(),e=this.hpath.width()},this.bindEvent(t(window),"resize."+this.settings.id,this.doresize),this.setScroll=function(t,i,s){this.scroll(this.vslider.position().top-t*(this.vtrack/this.vdiff),this.hslider.position().left+i*(this.htrack/this.hdiff),s),this.sliders.stop().fadeTo(this.settings.sliderOpacityTime,1),window.clearTimeout(this.timer),this.timer=window.setTimeout(this.fixFn(function(){this.sliders.stop().fadeTo(this.settings.sliderOpacityTime,this.settings.sliderOpacity)}),this.settings.sliderOpacityDelay)},this.bindEvent(this.container,"mousewheel",function(t,i,s,e){var h=t.target.nodeName;return"TEXTAREA"==h||"SELECT"==h||"OPTION"==h?void t.stopPropagation():(this.setScroll(this.settings.wheelSpeed*e,this.settings.wheelSpeed*s,t),void(this.settings.blockGlobalScroll&&(this.vdiff||this.hdiff)&&(t.preventDefault(),t.stopPropagation())))}),this.bindEvent(this.container,"mousedown",function(){this.settings.isFocus=-1}),this.bindEvent(i,"mousedown."+this.settings.id,function(){this.settings.isFocus=-1===this.settings.isFocus?1:0}),this.bindEvent(i,"keydown."+this.settings.id,function(t){if(1===this.settings.isFocus){var i=t.keyCode,s=0,e=0;e=38==i?this.settings.keyScroll:40==i?-this.settings.keyScroll:e,s=37==i?this.settings.keyScroll:39==i?-this.settings.keyScroll:s,(e||s)&&this.setScroll(e,s)}}),this.bindEvent(this.container,"dragstart",function(t){t.preventDefault()}),this.bindEvent(this.container,"rollbar",function(t,i,s,e){switch(t.stopPropagation(),i){case"reset":return this.container.find(".rollbar-content, .rollbar-handle").css({top:0,left:0}),this.pathSize(),this.checkScroll(),void this.checkIcon();case"sync":return void this.scroll((s||0)*this.vtrack,(e||0)*this.htrack);case"to":return this.pathSize(),this.checkScroll(),void this.scroll((s||0)*this.vtrack,(e||0)*this.htrack);case"pathsize":return this.pathSize(),this.checkScroll(),this.vslider.css("top",-this.content.position().top/this.vdiff*this.vtrack+"px"),void this.checkIcon();case"resize":return void this.doresize()}i=i||0,s=s||0,/^[-\d\.]+$/.test(i)&&(i=parseFloat(i),Math.abs(i)<=1&&!e?i*=this.vtrack:i+=i*(this.vtrack/this.vdiff-1)),/^[-\d\.]+$/.test(s)&&(s=parseFloat(s),Math.abs(s)<=1&&!e?s*=this.htrack:s+=s*(this.htrack/this.hdiff-1)),this.easeScroll(i,s)})},t.fn.rollbar=function(e){return this.each(function(){new i(this,t.extend({},s,e))})},t.rollbarSetup=function(i){t.extend(s,i)}}(jQuery);!function(e){e.autocomplete=function(t,n){function a(t){var n=C.find("li");n&&(w+=t,0>w?w=0:w>=n.size()&&(w=n.size()-1),n.removeClass("ac_over"),e(n[w]).addClass("ac_over"))}function o(){T&&clearTimeout(T),C.is(":visible")&&C.hide()}function l(n){n||(n=document.createElement("li"),n.extra=[],n.selectValue="");var a=e.trim(n.selectValue||n.innerHTML);t.lastSelected=a,g=a,C.html(""),p.val(a),o(),v.onItemSelect&&setTimeout(function(){v.onItemSelect(n)},1)}function i(){var e=C.find("li.ac_over")[0];if(!e){var t=C.find("li");v.selectOnly?1===t.length&&(e=t[0]):v.selectFirst&&(e=t[0])}return e&&l(e),!!e}function s(){var e=p.offset();C.show().offset({top:e.top+p.outerHeight(),left:e.left})}function c(){T&&clearTimeout(T),T=setTimeout(o,200)}function r(t){var n,a=document.createElement("ul"),o=t.length;for(v.maxItemsToShow>0&&v.maxItemsToShow<o&&(o=v.maxItemsToShow),n=0;o>n;n++){var i=t[n];if(i){var s=document.createElement("li");s.innerHTML=i,s.selectValue=i,a.appendChild(s)}}return e(a).children("li").hover(function(){e("li",a).removeClass("ac_over"),e(this).addClass("ac_over"),w=e("li",a).indexOf(e(this).get(0))},function(){e(this).removeClass("ac_over")}).click(function(e){e.preventDefault(),e.stopPropagation(),l(this)}),a}function u(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function f(t,n){var a=new RegExp(u(n),v.matchCase?void 0:"i");return e.grep(t,function(e){return a.test(e)})}function m(e){!x||e[0]?(C.html(""),C.append(r(e)),s()):o()}function d(e){m(f(v.data,e))}function h(){var e=p.val();e!==g&&(g=e,e.length>=v.minChars?d(e):v.showAllItem&&!e?m(v.data):C.hide())}var v=e.extend({data:{},inputClass:"ac_input",resultsClass:"ac_results",minChars:1,delay:400,matchCase:0,selectFirst:!1,selectOnly:!1,maxItemsToShow:12,showAllItem:!0,focusSelect:!0,con:e("body")},n),p=e(t).attr("autocomplete","off");v.inputClass&&p.addClass(v.inputClass);var C=e("<div/>");C.hide().addClass(v.resultsClass).css("position","absolute"),v.con.append(C);var T=null,g=p.val(),w=-1,x=0,y=null;o(),p.keydown(function(e){switch(y=e.keyCode,e.keyCode){case 38:e.preventDefault(),a(-1);break;case 40:e.preventDefault(),a(1);break;case 9:case 13:i()&&(p.get(0).blur(),e.preventDefault());break;default:w=-1,T&&clearTimeout(T),T=setTimeout(function(){h()},v.delay)}}).focus(function(){!x&&v.focusSelect&&setTimeout(function(){p.select()},0),x=1,v.showAllItem&&!p.val()&&m(v.data)}).blur(function(){x=0,c()})},e.fn.autocomplete=function(t){return this.each(function(){var n=this;e.autocomplete(n,t)}),this},e.fn.indexOf=function(e){var t;for(t=0;t<this.length;t++)if(this[t]===e)return t;return-1}}(jQuery);var Lrc=function(){function t(t){for(var i=0,e=this.lines.length;e>i&&!(t<=this.lines[i].time);i++);return i}function i(t){this.handler.call(this,this.lines[t].txt,{originLineNum:this.lines[t].originLineNum,lineNum:t})}Date.now=Date.now||(new Date).getTime;var e=/\[(\d{1,})\:(\d{1,2})(?:\.(\d{2}))?\]/g,n={title:"ti",artist:"ar",album:"al",offset:"offset",by:"by"},s=function(t,i){t=s.trim(t),this.lrc=t,this.handler=i||function(){},this.tags={},this.lines=[],this.txts=[],this.isLrc=s.isLrc(t),this.curLine=0,this.state=0;var r,a,l,c,h=t.split(/\n/);for(var u in n)r=t.match(new RegExp("\\["+n[u]+":([^\\]]*)\\]","i")),this.tags[u]=r&&r[1]||"";e.lastIndex=0;for(var o=0,f=h.length;f>o;o++)for(;l=e.exec(h[o]);)c=e.lastIndex,a=s.trim(h[o].replace(e,"")),e.lastIndex=c,this.lines.push({time:60*parseInt(l[1],10)*1e3+1e3*parseInt(l[2],10)+10*(parseInt(l[3],10)||0),originLineNum:o,txt:a}),this.txts.push(a);this.lines.sort(function(t,i){return t.time-i.time})};return s.prototype={settime:function(e,n){var s=this;s.isLrc&&(s.curLine=t.call(s,e),n||s.curLine&&i.call(s,s.curLine-1))}},s.trim=function(t){return t.replace(/(^\s*|\s*$)/m,"")},s.isLrc=function(t){return e.test(t)},s}();$.extend($.xm,{bbt:function(t,e){var i=$(t),a=i.children("dl"),n=e.ms.runtime,r=i.attr("i")||"",s="bible"+r,o="more"+r;a.click(function(t){var i,a=$(t.target);a.is("dd")&&(a.is(".on")||(i=a.attr("i"),n[s]=i,0!==e.cm.exmore(n[o],"minchapter")||e.ms.bibleinfo[i].su||(n[o]="1"),e.doc.th("viewbible")),e.doc.th("close"))})},menu:function(t,e){var i=e.ms,a=e.cm,n=i.runtime,r=e.doc,s=$(t),o=s.parent().attr("i")||"",l=s.find("div.hd em"),c=e.ms.bibleinfo,d=l.filter(".b:first"),h=l.filter(".r:first"),f=l.filter(".au"),m=l.filter(".ch"),u="bible"+o,p="roll"+o,b="more"+o;d.data("htmlData",function(t){function e(t){var e,i=[],a=n[u];for(e=0;e<t.length;e++)i.push([t[e][0],t[e][1],a===t[e][0]]);return{blist:i}}var a=i.bibleList;a?t(e(a)):$.getJSON(i.bspath+"list",function(a){i.bibleList=a,t(e(a))})}),h.data("htmlData",function(t){a.getInfo(n[u],function(e){var i,a=e.bx,r=[],s=[],l=n["roll"+o];for(i=0;39>i;i++)r.push([i+1,a[i],l===i+1]);for(i=39;66>i;i++)s.push([i+1,a[i],l===i+1]);t({oldlist:r,newlist:s,about:e.cp,bible:e.cv})})}),o?(l.attr("i",o),f.hide(),m.click(function(){var t=n.bible;n.bible=n.bible2,n.bible2=t,t=n.roll,n.roll=n.roll2,n.roll2=t,t=n.more,n.more=n.more2,n.more2=t,t=n.verse,n.verse=n.verse2,n.verse2=t,r.th("viewbible")})):(m.hide(),f.data("htmlData",function(t){a.getMedia(function(e){e.length>1?t({media:e}):r.th("playit",[0])})}));var v=[[n[u],n[p],n[b]]],g=0,y=l.filter(".ba"),w=l.filter(".fo");r.bind("viewbible."+e.id,function(t,e,i){if(i)e===o&&(g+=i);else{var a=[n[u],n[p],n[b]];v[g].join("/")!==a.join("/")&&(g&&(v.splice(0,g),g=0),v.unshift(a))}g?w.removeClass("dis"):w.addClass("dis"),v.length-1>g?y.removeClass("dis"):y.addClass("dis")}),s.find("div.fr").click(function(t){var e=$(t.target);a.getInfo(n[u],function(t){if(!e.is(".dis")){var s,l=t.su?"0":"1";e.is("em.pr")?(s=a.exmore(n[b],"minchapter"),s>l?n[b]=(s-1).toString():(n[p]>1?n[p]--:n[p]=66,n[b]=i.cnum[n[p]-1].toString()),n.sync2&&!o&&(n.more2=n.more,n.roll2=n.roll),r.th("viewbible")):e.is("em.nx")?(s=a.exmore(n[b],"maxchapter"),s<i.cnum[n[p]-1]?n[b]=(s+1).toString():(n[p]<66?n[p]++:n[p]=1,n[b]=l),n.sync2&&!o&&(n.more2=n.more,n.roll2=n.roll),r.th("viewbible")):e.is("em.ba")?(s=v[g+1],n[u]=s[0],n[p]=s[1],n[b]=s[2],r.th("viewbible",[o,1])):e.is("em.fo")&&(s=v[g-1],n[u]=s[0],n[p]=s[1],n[b]=s[2],r.th("viewbible",[o,-1]))}})}),r.bind("settitle."+e.id,function(t,e){if(o===e){var i,r=c[n[u]];d.html(r.cv).attr("title",r.cv),i=r.bx[n["roll"+o]-1]+" "+a.exmore(n[b],"strchapter").replace(/^0/,gettext("Summary")),h.html(i).attr("title",i),r.av&&(a.exmore(n[b],"minchapter")||r.su>1)?f.removeClass("dis"):f.addClass("dis"),o||(i=document.title.split("|"),document.title=r.bx[n.roll-1]+" "+n[b].toString().replace(/^0/,gettext("Summary"))+" "+r.cv+" | "+$.trim(i[i.length-1]))}})},mesi:function(t,e){function i(){n.width()<427?r.addClass("sb"):r.removeClass("sb"),c.offset().left-s.offset().left<70?(o.hide(),l.hide()):(o.show(),l.show())}var a=$(t),n=a.children("div.hd"),r=n.find("em.b"),s=n.find("em.au"),o=n.find("em.ba"),l=n.find("em.fo"),c=n.find("em.pr");s.is(":hidden")&&(s=s.next("em")),i(),e.win.bind("resize."+e.id,i),a.bind("show",i)},set:function(t,e,i){var a,n=$(t),r=e.cm.setCache;r||(r={},e.cm.setCache=r),n.click(function(s){var o=$(s.target).closest("*[t]",t);if(o[0]&&o.attr("t").indexOf(".")>=0){var l=o.attr("cache");if(o.is(".on"))o.removeClass("on"),a&&(l?a.css({left:"-99999px"}).th("hide"):(e.cm.ubj(a),a.remove()),a=0);else if(!o.is(".dis")){var c=o.data("htmlData"),d=function(s){var c=o.attr("t");l&&r[c]?setTimeout(function(){if(a=r[c],a.data("tag",o).th("show"),o.addClass("on"),i){var t=o.offset();a.offset({left:t.left-2,top:t.top+o.outerHeight()})}},1):o.is("em.au")&&e.ms.player?(n.is("div.gpmin")?n.removeClass("gpmin").find("#audi").removeClass("playmin"):n.addClass("gpmin").find("#audi").addClass("playmin"),n.children("div.bd").th("rollbar","resize")):$.ejs({name:c,data:i?$.extend({},e.ms.htmlData,{id:o.attr("i")},s):$.extend({},e.ms.htmlData,s),back:function(n){if(!o.is(".on")){if(a){var s=a.data("tag").removeClass("on");s.attr("cache")?a.css({left:"-99999px"}).th("hide"):e.cm.ubj(a)}else if(i){var d=o.offset();a=$('<div class="gml"/>').appendTo(e.body).offset({left:d.left-2,top:d.top+o.outerHeight()})}else a=$('<div class="gml"/>').appendTo(t);if(a.data("tag",o).html(n),o.addClass("on"),e.cm.bjs(a),l&&(r[c]=a),i){var h=a.outerWidth(),f=a.offset(),m=e.body.width();h+f.left>m&&a.css({left:m-h,top:f.top})}}}})};c&&$.isFunction(c)?c(d):d(c||{})}}else o.is(".on")?(o.removeClass("on"),e.ms.runtime[o.attr("t")]=0):(o.addClass("on"),e.ms.runtime[o.attr("t")]=1)}),e.doc.bind("close."+e.id,function(){if(a){var t=a.data("tag").removeClass("on");t.attr("cache")?a.css({left:"-99999px"}).th("hide"):(e.cm.ubj(a),a.remove()),a=0}}),e.doc.bind("click."+e.id,function(t){if(a&&!a.has(t.target)[0]){var i=a.data("tag").removeClass("on");i.attr("cache")?a.css({left:"-99999px"}).th("hide"):(e.cm.ubj(a),a.remove()),a=0}})},brl:function(t,e){function i(){var t=e.body.height(),i=C.offset().top,a=x.height(),n=t-i-10;C.css("height",parseInt(a>n?n:a,10)+"px")}function a(t){l.getInfo(c[f],function(e){var a,n=[];for(r=e.su?0:1;r<=d[t-1];r++)n.push("<li"+(t===c[m]&&l.exmore(c[u],"inchapter",r)?' class="on"':"")+' ii="'+r+'">'+(r||gettext("Summary"))+"</li>");x.html(n.join("")),i(),a=x.children("li.on"),a[0]?l.toMid(C,x,a):C.th("rollbar","reset")})}function n(){!h&&c.sync2&&(c.roll2=c.roll,c.more2=c.more)}var r,s=$(t),o=e.ms,l=e.cm,c=o.runtime,d=o.cnum,h=s.attr("i")||"",f="bible"+h,m="roll"+h,u="more"+h,p=s.find("div.ct"),b=$(p[0]),v=$(p[1]),g=b.find("ul"),y=v.find("ul"),w=s.find("div.ve"),C=w.find("div.vt"),x=w.find("ul");e.win.bind("resize."+e.id,function(){i()}),l.setHeight(e.id,p,g),p.rollbar({id:e.id}),C.rollbar({id:e.id}),l.toMid(b,g,g.children("li.on")),l.toMid(v,y,y.children("li.on")),a(c[m]),w.outerWidth()+w.offset().left>e.body.width()&&w.addClass("vl"),s.click(function(t){var i,r=$(t.target);r.is("li[i]:not(.on)")?(g.children("li.on").removeClass("on"),y.children("li.on").removeClass("on"),r.addClass("on"),a(parseInt(r.attr("i"),10))):r.is("li[ii]")?(i=g.children("li.on"),i[0]?c[m]=parseInt(i.attr("i"),10):(i=y.children("li.on"),c[m]=parseInt(i.attr("i"),10)),c[u]=r.attr("ii"),n(),e.doc.th("viewbible"),e.doc.th("close")):"ves"===r.attr("t")&&(e.cm.getInfo(c[f],function(t){t.cp&&"1"!==t.cp?$.ejs({name:"main.about",data:{content:t.cp},back:function(t){$.dialog({html:t,title:r.html(),width:800,height:400})}}):$.get(e.ms.bspath+"about/"+c[f]+"/",function(e){t.cp=e,$.ejs({name:"main.about",data:{content:e},back:function(t){$.dialog({html:t,title:r.html(),width:800,height:400})}})})}),e.doc.th("close"))}).dblclick(function(t){var i=$(t.target);i.is("li")&&(c[m]=parseInt(i.attr("i"),10),c[u]="1",n(),e.doc.th("viewbible"),e.doc.th("close"))})},lobb:function(t,e){function i(t,e){var i,a;if(t)for(a=t.length,i=0;a>i;i++)t[i].addClass(e)}function a(t){var e,a=v.exmore(g[z],"verse");if(t=t||"hi",p.find("."+t).removeClass(t),h[1]){if(a[0]&&a[1]){for(i(v.getVerse(h[0],a[0]+"-"),t),e=1;e<h.length-1;e++)i(v.getVerse(h[e],"1-"),t);i(v.getVerse(h[e],"1-"+a[1]),t)}}else a[0]&&i(v.getVerse(h,a[0]),t);return e=p.find("."+t+":first"),setTimeout(function(){v.toMid(u,p,e)},0),e[0]}function n(t,e){b.player&&b.playindex>=0&&v.getMedia(function(i){var a=i[2];if(a){var n=new RegExp("\\[(\\d{1,})\\:(\\d{1,2})(?:\\.(\\d{2}))?\\][ \\t]*"+t.match(/[\d\:*\d*]+/)[0].split(":")[g.lstype?1:0]+"(?:\\D|$)",""),r=n.exec(a);void 0!==e&&e!==b.offset&&(b.offset=e,b.player.load(i[1])),b.player.skipToTime(60*parseInt(r[1],10)+parseInt(r[2],10)+(parseInt(r[3],10)||0)/100)}},b.playindex,e)}function r(t,e){f.is(":hidden")||(!g[x]||g[x]===o&&g[k]===l&&g[z]===s&&g.lstype===d?e===w&&v.exmore(g[z],"verse")[0]&&(a(),m.th("settitle",[w]),n(v.exmore(g[z],"verse")[0])):v.getBible(w,function(t){function e(t){var e=b.bibleinfo[o].bm,i=g[k];return t.replace(/(\d?[^\d\s\.\:；．，\,\-－—\(\)（）·‧]{1,9}?)?\s*([\d\,\-－—，．：\:\.·‧]+)/g,function(t,a,n){if(a){if(a=$.inArray(a,e),0>a)return t;a+=1,i=a}else a=i;return n=n.replace(/\s*[：\:．\.·‧]\s*/g,":").replace(/\s*[\-－—]\s*/g,"-").replace(/\s*[，\,]\s*/g,","),interpolate('<em to="%s/%s">%s</em>',[a,n,t])})}C.detach(),y=0,o=g[x],l=g[k],s=g[z],c=v.exmore(g[z],"listchapter"),d=g.lstype,t=t.split("\n");var i,r=[];for(i=0;i<t.length;i++){var S=t[i];S=S.replace(/[\(（]\s*[^\n\r\t\(\)（）<>]+?\s*[\)）]/g,e),d&&c[0]?(S=S.replace(/(<\/?p[^>]*?>)|(<br\/?>)/g,"").replace(/<\/span><span>/g,"").replace(/(<(?:b|span)>.+?<\/span>)/g,"<p>$1</p>").replace(/<b>(\d+-?\d*)<\/b>/g,"<b>"+c[i]+":$1</b>"),p.addClass("gbs")):p.removeClass("gbs"),r.push('<div class="ct" i="'+i+'" c="'+c[i]+'">'),r.push(c[i]?"<h1>"+b.bibleinfo[o].bx[l-1]+" "+c[i]+"</h1>"+S:"<h1>"+b.bibleinfo[o].bx[l-1]+" "+gettext("Summary")+"</h1>"+S.replace(/^<h1>\S+?<\/h1>/,"")),r.push("</div>")}if(p.html(r.join("")),h=p.children("div"),setTimeout(function(){u.th("rollbar","reset"),a()},0),m.th("settitle",w),!w&&b.player&&v.getInfo(o,function(t){t.av>b.playindex?(b.offset=0,b.player.playbible(b.playindex),i=v.exmore(g[z],"verse")[0],i&&n(i)):m.th("playclose")}),w&&g.sync2){var I=f.data("sync");I&&(f.removeData("sync"),u.th("rollbar",["sync",I,0]))}},function(){y?(y=0,g[x]=b.bibleList[(parseInt(w,10)||1)-1][0],r(0,w),f.th("biblewaring")):u.append(C)}))}var s,o,l,c,d,h,f=$(t),m=e.doc,u=$("div.bd",t),p=u.children("div.gbt"),b=e.ms,v=e.cm,g=b.runtime,y=1,w=f.parent().attr("i")||"",C=$('<div class="el"><button>'+gettext("Failed to load, click reload")+"</button></div>"),x="bible"+w,k="roll"+w,z="more"+w;g[x]&&r(0,w),m.bind("viewbible."+e.id,r),m.bind("fontsize."+e.id,function(){p.css("fontSize",g.fontsize+"%"),u.th("rollbar","resize")}),C.children("button").click(function(){r(0,w)}),w||(m.bind("lrclight."+e.id,function(t,e,a){if(e){var n=$(h[a||b.offset||0]),r=n.find("b.ah:first");r[0]&&r.html()==e||(n.find(".ah").removeClass("ah"),i(v.getVerse(n,e),"ah"),v.toMid(u,p,n.find(".ah:first")))}else p.find(".ah").removeClass("ah"),(a||b.offset)>h.length-2&&u.th("rollbar","reset")}),p.click(function(t){var e=$(t.target);e.is("b")&&n(e.html(),parseInt(e.closest("div.ct").attr("i"),10))})),f.bind("show",function(){r(),u.th("rollbar","resize")})},tbtn:function(t,e){function i(t,i){var a=t.children("div").attr("id"),r=n["showin"+i],s=["main.content","main.search","main.zhuti"];!r&&"cote"===a||1===r&&"serh"===a?t.children("div.mod").th("show"):s[r||0]&&(e.cm.ubj(t),$.ejs({name:s[r||0],data:e.ms.htmlData,back:function(i){t.html(i),e.cm.bjs(t)}}))}var a=$(t),n=e.ms.runtime,r=$("#main>div.yu"),s=$(r[0]);r=$(r[1]),a.click(function(t){var i=$(t.target);i.is("em.sl0")||i.is("em.sl")?(n.lstype=1,i.removeClass("sl0").addClass("sl1"),e.doc.th("viewbible")):i.is("em.sl1")?(n.lstype=0,i.removeClass("sl1").addClass("sl0"),e.doc.th("viewbible")):i.is("em.sc")?(i.removeClass("sc").addClass("sc2"),n.sync2=1):i.is("em.sc2")?(i.removeClass("sc2").addClass("sc"),n.sync2=0):i.is("em.so")?($("#lay>#bd").addClass("yso"),i.removeClass("so").addClass("so1"),n.hideleft=1,e.win.th("resize")):i.is("em.so1")&&($("#lay>#bd").removeClass("yso"),i.removeClass("so1").addClass("so"),n.hideleft=0,e.win.th("resize"))}),e.doc.bind("swin."+e.id,function(t,o){o>=0&&(a.find("em.ab"+n.showb2).removeClass("ab"+n.showb2).addClass("ab"+o),$("#bd").removeClass("ysb"+n.showb2).addClass("ysb"+o),n.showb2=o),1===n.showb2||2===n.showb2?(i(s,1),i(r,2)):n.showb2||(r.children("div.mod").th("hide"),e.win.th("resize"))})},sefo:function(t,e){var i=$(t),a=e.ms.runtime,n=[75,90,100,110,125,150,175,200,250,300,350],r=function(t,e){var i;if(e>0){for(i=0;i<n.length;i++)if(n[i]>t)return n[i]}else if(0>e)for(i=n.length-1;i>=0;i--)if(n[i]<t)return n[i];return t},s=i.children("div:first").click(function(t){switch(t.target.getAttribute("t")){case"+":a.fontsize=r(a.fontsize||100,1),e.doc.th("fontsize"),s.html(a.fontsize+"%");break;case"-":a.fontsize=r(a.fontsize||100,-1),e.doc.th("fontsize"),s.html(a.fontsize+"%")}}).find("span:first")},audo:function(t,e){var i=$(t);i.find("li[i="+e.ms.playindex+"]").addClass("on"),i.click(function(t){var i=$(t.target);i.is("li[i]")&&(e.doc.th("playit",[parseInt(i.attr("i"),10)]),e.doc.th("close"))})},nxwd:function(t,e){var i=$(t),a=e.ms.runtime;i.find("em.ab"+a.showb2).addClass("on"),i.click(function(t){var i=$(t.target),n=i.attr("class");e.doc.th("close"),a.showin1=0,a.showin2=0,e.doc.th("swin",parseInt(n.substr(2),10))})},seah:function(t,e){var i,a=$(t),n=a.find("div.bd>form:first"),r=e.ms.runtime,s=n.submit(function(){var a,o,l=$.trim(s.val()).replace(/\\|\/|\^|\$|\*|\+|\?|\{|\}|=|<|>|_/g,"");if(s.val(l),e.cm.valid(t,n)>0)return!1;for(i=r.bible,1!==r.showin2&&(e.ms.oldshowb2=r.showb2),r.showb2?1!==r.showin2&&(r.showin2=1,e.doc.th("swin")):(r.showin2=1,e.win.width()>e.win.height()?e.doc.th("swin",1):e.doc.th("swin",2)),r.search={q:l},$.post(e.ms.bspath+"search/"+i+"/",r.search,function(t){e.ms.search=[i,l,t.split("\n")],e.doc.th("search")}),o=r.searchkey.length,a=0;o>a;a++)if(r.searchkey[a]===l){r.searchkey.splice(a,1);break}return r.searchkey.unshift(l),o>200&&(r.searchkey.length=200),!1}).children("input[name=q]");r.search&&s.val(r.search.q),r.searchkey||(r.searchkey=[]),s.autocomplete({data:r.searchkey,onItemSelect:function(){s.trigger("input")}}),e.doc.bind("vsubmit."+e.id,function(){n.th("submit")})},serh:function(t,e){function i(t,i){e.cm.getInfo(t[0],function(e){var a,n,r=["<ul>"],s=0,o=t[2],l=e.bx,c=o.length,d=/_(?=\S)(.*?\S)_/g,h=/\.\.(?=\S)(.*?\S)\.\./g,f=/\*(?=\S)(.*?\S)\*/g,m=new RegExp(t[1].replace(/\s+/g,"|"),"gi"),u=/^(\d{1,2})\s(\d{1,3}:[\d,\-]+)\s?(.*)$/;for("..."===o[c-1]&&(c-=1,s=1),a=0;c>a;a++)n=u.exec(o[a]),n&&r.push('<li i="'+n[1]+"|"+n[2]+'"><h4>'+l[parseInt(n[1],10)-1]+" "+n[2]+"</h4><p>"+n[3].replace(d,"<i>$1</i>").replace(f,"<em>$1</em>").replace(h,"<ins>$1</ins>").replace(m,'<strong class="rd">$&</strong>')+"</p></li>");r.push("</ul>"),i(r,e,s)})}function a(){var t=e.ms.search;return t?void i(t,function(e,i,a){var n=e.length-2;r.html(i.cv+" "+(t[3]||"")+" [<strong>"+t[1]+"</strong>] (<span>"+(n>1e3?n+"+":n)+"</span>)"),o.html(e.join("")),a&&o.append('<em class="lm">'+gettext("Load more...")+"</em>"),s.th("rollbar","reset")}):void(l.search?1===l.showin2&&e.doc.th("vsubmit"):r.html(gettext("Please enter search keyword in the above and click search.")))}var n=$(t),r=n.find("div.hd"),s=n.find("div.bd"),o=n.find("div.gbt"),l=e.ms.runtime;e.doc.bind("search."+e.id,a).bind("fontsize."+e.id,function(){o.css("fontSize",l.fontsize+"%"),s.th("rollbar","resize")}),n.click(function(t){var a,n=$(t.target),c=n.closest("li[i]");if(c[0]){var d=c.attr("i").split("|");l.bible=e.ms.search[0],l.roll=parseInt(d[0],10),l.more=d[1],l.sync2&&(l.roll2=l.roll,l.more2=l.more),l.showin1&&(l.showin1=0,e.doc.th("swin")),e.doc.th("viewbible",[d[2],""]),o.find("li.on").removeClass("on"),c.addClass("on")}else n.is("em.cs")?(l.showin2=0,e.doc.th("swin",e.ms.oldshowb2)):n.is("em.lm")&&(a=e.ms.search,$.post(e.ms.bspath+"search/"+a[0]+"/",$.extend({},l.search,{t:parseInt(n.prev("ul").children("li:last").attr("i").split("|")[0],10)+1}),function(t){a[2]=t.split("\n"),i(a,function(t,e,i){var a=r.find("span");a.html(parseInt(a.html(),10)+t.length-2+(i?"+":"")),n.before(t.join("")),i||n.remove(),s.th("rollbar","pathsize")})}))}),s.rollbar({id:e.id}),a()},i18n:function(t,e){var i=$(t),a=e.ms.runtime,n=i.find("div.hd>form");n.append(e.lay.next("input:hidden").clone()),n.find("a").click(function(t){var i=$(t.target),r=i.attr("href");$.getJSON(e.ms.rootpath+"lv/"+r+"/"+a.bible+"/"+(a.bible2?a.bible2+"/":""),function(t){t[0]&&(a.bible=t[0]),t[1]&&(a.bible2=t[1]),e.doc.th("hashbible"),n.append('<input type="hidden" name="language" value="'+r+'"/>'),n.submit()}),t.preventDefault()})},ftip:function(t,e){$(t).mouseover(function(e){var i=$(e.target).closest(".wrg",t);i[0]&&i.tooltip({html:i.attr("wmsg")||i.attr("wtit"),cls:"gt4",position:i.attr("pt")||"left"})}).bind("wrongtip",function(t){var e=$(t.target);e.tooltip({html:e.attr("wmsg")||e.attr("wtit"),cls:"gt4",sticky:1,position:e.attr("pt")||"left"}),setTimeout(function(){e.focus().select()},99)}).bind("focusin focus",function(e){var i=$(e.target),a=i.closest(".wrg",t);a[0]&&setTimeout(function(){a.tooltip({html:a.attr("wmsg")||a.attr("wtit"),cls:"gt4",sticky:1,position:a.attr("pt")||"left"})},99),a=i.closest("[tit]",t),a[0]&&setTimeout(function(){a.tooltip({html:a.attr("tit"),cls:"gtl",sticky:1,position:a.attr("pt")||"right",queue:"tooltip"+t.id})},500)}).bind("focusout keyup change input propertychange",function(i){var a=$(i.target);a.is(":input[name]")&&e.cm.valid(t,a,function(t){return t[0]||a.th("hidetip"),!1})})},btip:function(t){var e=$(t),i=e.find("div.gbt"),a=e.children("div.bd");e.mouseover(function(e){var n,r=$(e.target);if(r.is("sup")){if(n=r.attr("tit"),n||(n=r.attr("title"),r.removeAttr("title"),r.attr("tit",n)),"ontouchstart"in document.documentElement)return;r.tooltip({html:n,con:i,vcon:a,sticky:1,own:t})}}).click(function(t){var e=$(t.target);e.is("sup")?(e.after("<code>"+(e.attr("tit")||e.attr("title"))+'<em title="'+gettext("Close")+'"></em></code>'),e.hide().th("hidetip")):e.is("em")&&e.parent().is("code")&&(e.parent().prev().show(),e.parent().remove())})},bili:function(t,e){var i=$(t),a=i.attr("i")||"",n=e.ms.runtime;i.find("div.gbt").click(function(t){var i=$(t.target);if(i.is("em[to]")){var r=i.attr("to").split("/");n.bible2=n["bible"+a],n.roll2=parseInt(r[0],10),n.more2=/^\d+$/.test(r[1])?r[1]+":1-":r[1],n.showb2&&0===n.showin2||(n.showin2=0,n.showb2?e.doc.th("swin"):e.doc.th("swin",2)),setTimeout(function(){e.doc.th("viewbible","2")},9)}})},scro:function(t,e){var i=$(t),a=e.ms.runtime,n=i.find("div.bd:first"),r=i.parent().attr("i")||"";r&&(e.ms.bibleScroll=function(t){!a.sync2||1!==a.showb2&&2!==a.showb2||a.roll!==a.roll2||e.cm.exmore(a.more,"strchapter")!==e.cm.exmore(a.more2,"strchapter")||(n.th("rollbar",["sync",t,0]),i.data("sync",t))}),n.rollbar({id:e.id,isFocus:r?0:1,onscroll:r?function(){}:function(t){e.ms.bibleScroll&&e.ms.bibleScroll(t)}})},doau:function(t,e){var i=$(t),a=e.ms,n=i.parent().attr("i");if(!n){var r=$("<div/>");i.children("div.hd").after(r),r.addClass("au"),e.doc.bind("playit."+e.id,function(t,n){e.cm.getMedia(function(t){a.player?a.player.playbible(n):$.ejs({name:"main.audiopad",data:{audiosrc:t[1],index:n},back:function(t){r.html(t),e.cm.bjs(r),i.addClass("gau"),i.children("div.bd").th("rollbar","resize")}}),a.playindex=n},n)})}},audi:function(t,e){var i,a=$(t),n=e.ms,r=e.cm,s=e.doc,o=n.runtime,l=parseInt(a.attr("ai"),10);o.repeattype=o.repeattype||"0",r.getMedia(function(t){$.ejs({name:"main.audiojs",data:{playlang:t[4]},back:function(t){function c(){o.verse="",o.sync2&&(o.roll2=o.roll,o.more2=r.exmore(o.more,"strchapter"))}function d(){var t=n.cnum,e=r.exmore(o.more,"minchapter"),i=r.exmore(o.more,"maxchapter");if(i>e&&n.offset+e<i)return n.offset+=1,void n.player.playbible(l,1,n.offset);switch(n.offset=0,o.repeattype){case"1":i<t[o.roll-1]&&(o.more=(i+1).toString(),c(),s.th("viewbible"));break;case"2":i<t[o.roll-1]?(o.more=(i+1).toString(),c(),s.th("viewbible")):o.roll<t.length&&(o.roll+=1,r.getMedia(function(t){o.more=t[3]?"0":"1",c(),s.th("viewbible")},l));break;case"3":a.parent().next().th("rollbar",["sync",0,0]),n.player.playbible(l,1);break;case"4":i<t[o.roll-1]?(o.more=(i+1).toString(),c(),s.th("viewbible")):r.getMedia(function(t){o.more=t[3]?"0":"1",c(),s.th("viewbible")},l);break;case"5":i<t[o.roll-1]?(o.more=(i+1).toString(),c(),s.th("viewbible")):(o.roll<t.length?o.roll+=1:o.roll=1,r.getMedia(function(t){o.more=t[3]?"0":"1",c(),s.th("viewbible")},l))}}function h(){n.offset=0,n.player.pause(),n.playindex=-1,n.player=0;var t=a.closest("div.gau").removeClass("gau").children("div.bd");t.find(".ah").remove("ah"),t.th("rollbar","resize"),r.ubj(a.parent()),a.remove(),s.th("lrclight",[-1])}var f,m=0,u=-1,p=-1,b="";n.offset=0,n.player=audiojs.create(a.find("audio")[0],{autoplay:!0,createPlayer:{markup:t,playPauseClass:"play-pause",scrubberClass:"scrubber",progressClass:"progress",loaderClass:"loaded",timeClass:"time",durationClass:"duration",playedClass:"played",errorMessageClass:"error-message",playingClass:"playing",loadingClass:"loading",errorClass:"error"},trackEnded:function(){f&&(f=0,m=0,u=-1,p=-1,b="",s.th("lrclight",[0])),d()},play:function(){var t=this.settings.createPlayer;$(this.wrapper).removeClass(t.errorClass).addClass(t.playingClass),r.getMedia(function(t){var e=t[2];e&&(f=new Lrc(e,function(t){s.th("lrclight",[t.match(/[\d\-\,]+/)[0]])}))},l)},pause:function(){var t=this.settings.createPlayer;$(this.wrapper).removeClass(t.playingClass)},loadProgress:function(t){if(p>t&&(p=-1),t-p>.01){p=t;var e=this.settings.createPlayer,i=$("."+e.loaderClass,this.wrapper);i.css("width",100*t+"%")}},loadError:function(){var t=this.settings.createPlayer,e=$("."+t.errorMessageClass,this.wrapper);$(this.wrapper).addClass(t.errorClass),e.html(gettext("Load error, perhaps the audio is lost."))},loadStarted:function(){var t=Math.floor(this.duration/60),e=Math.floor(this.duration%60),i=(10>t?"0":"")+t+":"+(10>e?"0":"")+e;if(i!==b){b=i;var a=this.settings.createPlayer,n=$("."+a.durationClass,this.wrapper);$(this.wrapper).removeClass(a.errorClass),n.html(i)}},updatePlayhead:function(t){var e=parseInt(this.duration*t*10,10)/10;if(u=t,m!==e){m=e;var i=this.settings.createPlayer,a=$("."+i.progressClass,this.wrapper);a.css("width",100*t+"%");var n=$("."+i.playedClass,this.wrapper),r=Math.floor(e/60),s=Math.floor(e%60);n.html((10>r?"0":"")+r+":"+(10>s?"0":"")+s),f&&f.settime(1e3*e),u>p?$(this.wrapper).is("."+i.loadingClass)||$(this.wrapper).addClass(i.loadingClass):$(this.wrapper).is("."+i.loadingClass)&&$(this.wrapper).removeClass(i.loadingClass)}}}),i=a.find("audio>source").attr("src"),n.player.playbible=function(t,e,o){r.getMedia(function(r){if(e||i!==r[1]){i=r[1],a.find("em.playlang").html(r[4]),l=t,n.player.load(r[1]);var c=r[2];c?(s.th("lrclight",[0,-2]),f=new Lrc(c,function(t){s.th("lrclight",[t.match(/[\d\-\,]+/)[0],o])})):(f=0,s.th("lrclight",[-1]))}},t,o)},n.player.close=function(){h()},a.find("em.close").click(h),s.bind("playclose."+e.id,h),a.find("em.playlang").data("htmlData",function(t){r.getMedia(function(e){t({media:e})})});var v=a.find("div.grp"),g={0:gettext("Play one"),1:gettext("Play book"),2:gettext("Play bible"),3:gettext("Repeat one"),4:gettext("Repeat book"),5:gettext("Repeat bible")};v.data("htmlData",{rptype:g}).html('<em class="r'+o.repeattype+'" title="'+g[o.repeattype]+'"></em>'),s.bind("playrepeat."+e.id,function(){v.html('<em class="r'+o.repeattype+'" title="'+g[o.repeattype]+'"></em>')})}})},l)},amsg:function(t,e){function i(){$.ejs({name:"main.about",data:{content:a[1]},back:function(t){$.dialog({html:t,title:a[0],width:800,height:400})}})}var a;$("em.us",t).click(function(){a?i():$.get(e.ms.ampath+"designers/",function(t){a=t.split("\n"),i()})})},rept:function(t,e){var i=e.ms.runtime;$("li[i="+i.repeattype+"]",t).addClass("on"),$("li",t).click(function(){var t=this.getAttribute("i");i.repeattype!==t&&(i.repeattype=t,e.doc.th("playrepeat")),e.doc.th("close")})},tove:function(t,e){function i(){l.css("height",e.body.height()-l.offset().top-10-(o.outerHeight(!0)||0))}function a(){var t=c.find("li");$(t[Math.floor(Math.random()*t.length)]).addClass("on")}var n=$(t),r=e.ms,s=r.runtime,o=n.next(),l=n.find("div.vt"),c=l.children();i(),e.win.bind("resize."+e.id,function(){i()}),e.doc.bind("fontsize."+e.id,function(){c.css("fontSize",s.fontsize+"%"),l.th("rollbar","resize")}),a(),l.rollbar({id:e.id,showIcon:!1}),n.click(function(i){var a=$(i.target).closest("li",t);a[0]&&(c.find("li.on").removeClass("on"),a.addClass("on"),e.cm.getInfo(r.topicbible,function(t){var i=/^(\S+?)\s*(\d+:[\d\-,]+)$/.exec(a.find("h5").html()),n=$.inArray(i[1],t.bm)+1||$.inArray(i[1],t.bx)+1;n&&(s.bible=r.topicbible,s.roll=n,s.more=i[2],s.sync2&&(s.roll2=n,s.more2=i[2]),e.doc.th("viewbible",""))}))}),e.doc.bind("topic."+e.id,function(){n.find("h2>span").html(r.topickey);var t,i,a=[],s=r.topicval,d=s.length;for(t=0;d>t;t++)a.push("<li>"+s[t]+"</li>");var h=c.children("ul").html(a.join(""));if(!h.is(".so")){h.addClass("so");var f=function(){l.stop(!0).animate({height:e.body.height()-l.offset().top-10},function(){l.th("rollbar","resize"),e.cm.toMid(l,c,c.find("li.on"))}),i&&(clearTimeout(i),i=0)};f(),n.hover(f,function(){i&&clearTimeout(i),i=setTimeout(function(){l.stop(!0).animate({height:e.body.height()-l.offset().top-10-(o.outerHeight(!0)||0)},2e3,"swing",function(){l.th("rollbar","resize"),e.cm.toMid(l,c,c.find("li.on"))}),i=0},1e4)})}l.th("rollbar","reset")})},toli:function(t,e){var i=$(t);i.css("width",i.parent().data("tag").outerWidth()),e.cm.setHeight(e.id,i,i.children()),i.rollbar({id:e.id}),i.click(function(t){var i=$(t.target);return i.is("li")&&(e.cm.getTopic(i.html(),function(t,i){e.ms.topickey=t,e.ms.topicval=i,e.doc.th("topic")}),e.doc.th("close")),!1})},cpy:function(t,e){var i=$(t);i.rollbar({id:e.id}),i.find("img").load(function(){i.th("rollbar","resize")})},mres:function(t,e){function i(){e.win.width()<540&&a.showb2&&e.doc.th("swin",0)}{var a=e.ms.runtime,n=$(t),r=n.find("em.aa");r.prev(),r.next(),n.find("input")}i(),e.win.bind("resize."+e.id,i)},docv:function(t,e){function i(){e.cm.getInfo(r[o],function(t){c.html(interpolate(gettext('You choose the version of the Bible does not exist or is not in the current locale, automatically go to "%s"'),[t.cv])+d),l.fadeIn(),a&&clearTimeout(a),a=setTimeout(function(){l.fadeOut(),a=0},15e3)})}var a,n=$(t),r=e.ms.runtime,s=n.parent().attr("i")||"",o="bible"+s,l=n.children("div.ft"),c=l.children("div.nt"),d=c.html();!s&&r.biblewaring&&(i(),r.biblewaring=0),n.bind("biblewaring",i),c.click(function(t){var e=$(t.target);e.is("em.cx")&&(l.fadeOut(),a&&(clearTimeout(a),a=0))})},ldin:function(t,e){var i=0,a=$(t).find("img.ld");e.doc.ajaxStart(function(){i++,1===i&&a.stop(!0,!0).hide().fadeIn()}),e.doc.ajaxStop(function(){i--,0>=i&&(i=0,a.stop(!0).fadeOut())})},gmsg:function(t,e){var i,a=$(t),n=a.find("span.er");e.doc.ajaxStart(function(){i&&(clearTimeout(i),n.stop(!0).fadeOut(),i=0)}),e.doc.ajaxError(function(){i&&(clearTimeout(i),i=0),i=setTimeout(function(){i=0,n.stop(!0).fadeOut()},5e3),n.stop(!0,!0).hide(),n.fadeIn()})}}),$.extend($.bj,{cote:"docv|doau|menu|lobb|set/1|btip|bili|scro|mesi",hede:"tbtn|set/1|seah|ftip|i18n|amsg|mres|ldin|gmsg",tove:"tove|set"});!function(e){function i(){var i=document.location.pathname.split("/");i.length>2&&(n.bible=i[1],n.roll=e.inArray(i[2],l.bibleshort)+1||parseInt(i[2],10)||1,n.more=i[3],n.sync2&&(n.roll2=n.roll,n.more2=n.more));var t=window.cversion;t&&(n.bible=t[0],a.th("hashbible",!1),delete window.cversion,n.biblewaring=1)}var t=e.cm,l=e.ms,a=e.ss.doc;if(!e("div.yie")[0]){e.ajaxSetup({error:function(i){try{t.act(e.parseJSON(i.responseText))}catch(l){t.act({500:l.type})}},timeout:5e3}),l.debug&&e.storageSetup({space:l.version});{l.runtime=e.extend({bible:"",roll:1,more:"1",bible2:"",roll2:1,more2:"1",sync2:0,showb2:1,showin1:0,showin2:0,lstype:0,fontsize:125,hideleft:0,repeattype:"0"},e.storage("runtime")?e.parseJSON(e.storage("runtime")):{})}l.htmlData={ms:l,rt:l.runtime},e.ss.win.bind("unload",function(){e.storage("runtime",e.toJSON(l.runtime))});var n=l.runtime;if(window.history&&history.pushState){var o;a.bind("viewbible hashbible",function(e,i){var t="/"+n.bible+"/"+l.bibleshort[n.roll-1]+"/"+n.more+"/";o!==t&&(o=t,i!==!1?history.pushState(null,"",t):history.replaceState(null,"",t))}),e.ss.win.bind("popstate",function(){i(),a.th("viewbible",[!1])}),i()}else if(i(),document.location.pathname.length>1)return e.storage("runtime",e.toJSON(l.runtime)),void window.navigate("/");e.rollbarSetup({scroll:"vertical",pathPadding:"5px",zIndex:2});var s,r=e("textarea:hidden");if(e.ejsSetup({path:l.tplpath,ext:".html?"+l.version+(l.debug?e.cm.guid():"")}),e.ejsTpl("main",r[0].value),r[1]){s=r[1].value.replace(/^\[(\S+?)(\d+?:[\d\-,]+?)\](.+?)$/gm,"<h5>$1$2</h5><p>$3</p>").split("\n");var b=s.shift().split("|");l.topicbible=b.shift(),l.topicli=b,l.topickey=s.shift(),l.topic[l.topickey]=s,l.topicval=s}if(r[2]&&(l.bibles[document.location.pathname.replace(/^\/?(\S+?)\/?$/,"$1/")]=r[2].value),r[3]){s=r[3].value.split("|");var p=s[2].split("=");l.bibleinfo[s[0]]={bx:p[0].split(","),bm:p[1].split(","),cb:s[0],cv:s[1],av:parseInt(s[3],10),su:parseInt(s[4],10)||0,cp:s[5]}}r.remove(),window.biblelist&&(e.ms.bibleList=biblelist,n.bible=n.bible||biblelist[0][0],n.bible2=n.bible2||(biblelist[1][0]===n.bible?biblelist[0][0]:biblelist[1][0])),a.bind("command",function(i,t,a){switch(t=t.split("|"),t[0]){case"dialog":e.ejs({name:t[1],data:l.htmlData,back:function(i){e.dialog({html:i,title:t[2],width:t[3],height:t[4],bridge:a})}})}}),e.ejs({name:"main.index",data:e.ms.htmlData,back:function(i){t.bjs(e.ss.lay.html(i))}})}}(jQuery);